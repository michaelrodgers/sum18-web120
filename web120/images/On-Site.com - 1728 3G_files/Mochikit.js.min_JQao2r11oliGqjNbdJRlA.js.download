if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.Base")}if(typeof(MochiKit)=="undefined"){MochiKit={}}if(typeof(MochiKit.Base)=="undefined"){MochiKit.Base={}}if(typeof(MochiKit.__export__)=="undefined"){MochiKit.__export__=(MochiKit.__compat__||(typeof(JSAN)=="undefined"&&typeof(dojo)=="undefined"))}MochiKit.Base.VERSION="1.4";MochiKit.Base.NAME="MochiKit.Base";MochiKit.Base.update=function(d,c){if(d===null||d===undefined){d={}}for(var b=1;b<arguments.length;b++){var e=arguments[b];if(typeof(e)!="undefined"&&e!==null){for(var a in e){d[a]=e[a]}}}return d};MochiKit.Base.update(MochiKit.Base,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},camelize:function(b){var a=b.split("-");var d=a[0];for(var c=1;c<a.length;c++){d+=a[c].charAt(0).toUpperCase()+a[c].substring(1)}return d},counter:function(a){if(arguments.length===0){a=1}return function(){return a++}},clone:function(a){var b=arguments.callee;if(arguments.length==1){b.prototype=a;return new b()}},_deps:function(b,a){if(!(b in MochiKit)){MochiKit[b]={}}if(typeof(dojo)!="undefined"){dojo.provide("MochiKit."+b)}for(var c=0;c<a.length;c++){if(typeof(dojo)!="undefined"){dojo.require("MochiKit."+a[c])}if(typeof(JSAN)!="undefined"){JSAN.use("MochiKit."+a[c],[])}if(!(a[c] in MochiKit)){throw"MochiKit."+b+" depends on MochiKit."+a[c]+"!"}}},_flattenArray:function(c,a){for(var b=0;b<a.length;b++){var d=a[b];if(d instanceof Array){arguments.callee(c,d)}else{c.push(d)}}return c},flattenArray:function(a){return MochiKit.Base._flattenArray([],a)},flattenArguments:function(b){var e=[];var a=MochiKit.Base;var c=a.extend(null,arguments);while(c.length){var f=c.shift();if(f&&typeof(f)=="object"&&typeof(f.length)=="number"){for(var d=f.length-1;d>=0;d--){c.unshift(f[d])}}else{e.push(f)}}return e},extend:function(d,e,b){if(!b){b=0}if(e){var a=e.length;if(typeof(a)!="number"){if(typeof(MochiKit.Iter)!="undefined"){e=MochiKit.Iter.list(e);a=e.length}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(!d){d=[]}for(var c=b;c<a;c++){d.push(e[c])}}return d},updatetree:function(a,e){if(a===null||a===undefined){a={}}for(var d=1;d<arguments.length;d++){var f=arguments[d];if(typeof(f)!="undefined"&&f!==null){for(var c in f){var b=f[c];if(typeof(a[c])=="object"&&typeof(b)=="object"){arguments.callee(a[c],b)}else{a[c]=b}}}}return a},setdefault:function(c,d){if(c===null||c===undefined){c={}}for(var b=1;b<arguments.length;b++){var e=arguments[b];for(var a in e){if(!(a in c)){c[a]=e[a]}}}return c},keys:function(c){var b=[];for(var a in c){b.push(a)}return b},values:function(c){var a=[];for(var b in c){a.push(c[b])}return a},items:function(d){var a=[];var c;for(var f in d){var b;try{b=d[f]}catch(c){continue}a.push([f,b])}return a},_newNamedError:function(c,b,a){a.prototype=new MochiKit.Base.NamedError(c.NAME+"."+b);c[b]=a},operator:{truth:function(b){return !!b},lognot:function(b){return !b},identity:function(b){return b},not:function(b){return ~b},neg:function(b){return -b},add:function(d,c){return d+c},sub:function(d,c){return d-c},div:function(d,c){return d/c},mod:function(d,c){return d%c},mul:function(d,c){return d*c},and:function(d,c){return d&c},or:function(d,c){return d|c},xor:function(d,c){return d^c},lshift:function(d,c){return d<<c},rshift:function(d,c){return d>>c},zrshift:function(d,c){return d>>>c},eq:function(d,c){return d==c},ne:function(d,c){return d!=c},gt:function(d,c){return d>c},ge:function(d,c){return d>=c},lt:function(d,c){return d<c},le:function(d,c){return d<=c},seq:function(d,c){return d===c},sne:function(d,c){return d!==c},ceq:function(d,c){return MochiKit.Base.compare(d,c)===0},cne:function(d,c){return MochiKit.Base.compare(d,c)!==0},cgt:function(d,c){return MochiKit.Base.compare(d,c)==1},cge:function(d,c){return MochiKit.Base.compare(d,c)!=-1},clt:function(d,c){return MochiKit.Base.compare(d,c)==-1},cle:function(d,c){return MochiKit.Base.compare(d,c)!=1},logand:function(d,c){return d&&c},logor:function(d,c){return d||c},contains:function(d,c){return c in d}},forwardCall:function(a){return function(){return this[a].apply(this,arguments)}},itemgetter:function(a){return function(b){return b[a]}},typeMatcher:function(){var a={};for(var b=0;b<arguments.length;b++){var c=arguments[b];a[c]=c}return function(){for(var d=0;d<arguments.length;d++){if(!(typeof(arguments[d]) in a)){return false}}return true}},isNull:function(){for(var a=0;a<arguments.length;a++){if(arguments[a]!==null){return false}}return true},isUndefinedOrNull:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(!(typeof(b)=="undefined"||b===null)){return false}}return true},isEmpty:function(a){return !MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(b){for(var a=0;a<arguments.length;a++){var c=arguments[a];if(!(c&&c.length)){return false}}return true},isArrayLike:function(){for(var a=0;a<arguments.length;a++){var c=arguments[a];var b=typeof(c);if((b!="object"&&!(b=="function"&&typeof(c.item)=="function"))||c===null||typeof(c.length)!="number"||c.nodeType===3||c.nodeType===4){return false}}return true},isDateLike:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(typeof(b)!="object"||b===null||typeof(b.getTime)!="function"){return false}}return true},xmap:function(b){if(b===null){return MochiKit.Base.extend(null,arguments,1)}var c=[];for(var a=1;a<arguments.length;a++){c.push(b(arguments[a]))}return c},map:function(n,e){var a=MochiKit.Base;var g=MochiKit.Iter;var o=a.isArrayLike;if(arguments.length<=2){if(!o(e)){if(g){e=g.list(e);if(n===null){return e}}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(n===null){return a.extend(null,e)}var k=[];for(var d=0;d<e.length;d++){k.push(n(e[d]))}return k}else{if(n===null){n=Array}var h=null;for(d=1;d<arguments.length;d++){if(!o(arguments[d])){if(g){return g.list(g.imap.apply(null,arguments))}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}var b=arguments[d].length;if(h===null||h>b){h=b}}k=[];for(d=0;d<h;d++){var f=[];for(var c=1;c<arguments.length;c++){f.push(arguments[c][d])}k.push(n.apply(this,f))}return k}},xfilter:function(b){var c=[];if(b===null){b=MochiKit.Base.operator.truth}for(var a=1;a<arguments.length;a++){var d=arguments[a];if(b(d)){c.push(d)}}return c},filter:function(d,b,f){var e=[];var a=MochiKit.Base;if(!a.isArrayLike(b)){if(MochiKit.Iter){b=MochiKit.Iter.list(b)}else{throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}}if(d===null){d=a.operator.truth}if(typeof(Array.prototype.filter)=="function"){return Array.prototype.filter.call(b,d,f)}else{if(typeof(f)=="undefined"||f===null){for(var c=0;c<b.length;c++){var g=b[c];if(d(g)){e.push(g)}}}else{for(c=0;c<b.length;c++){g=b[c];if(d.call(f,g)){e.push(g)}}}}return e},_wrapDumbFunction:function(_a2){return function(){switch(arguments.length){case 0:return _a2();case 1:return _a2(arguments[0]);case 2:return _a2(arguments[0],arguments[1]);case 3:return _a2(arguments[0],arguments[1],arguments[2])}var _a3=[];for(var i=0;i<arguments.length;i++){_a3.push("arguments["+i+"]")}return eval("(func("+_a3.join(",")+"))")}},methodcaller:function(b){var a=MochiKit.Base.extend(null,arguments,1);if(typeof(b)=="function"){return function(c){return b.apply(c,a)}}else{return function(c){return c[b].apply(c,a)}}},method:function(c,b){var a=MochiKit.Base;return a.bind.apply(this,a.extend([b,c],arguments,2))},compose:function(b,f){var e=[];var a=MochiKit.Base;if(arguments.length===0){throw new TypeError("compose() requires at least one argument")}for(var c=0;c<arguments.length;c++){var d=arguments[c];if(typeof(d)!="function"){throw new TypeError(a.repr(d)+" is not a function")}e.push(d)}return function(){var h=arguments;for(var g=e.length-1;g>=0;g--){h=[e[g].apply(this,h)]}return h[0]}},bind:function(g,f){if(typeof(g)=="string"){g=f[g]}var d=g.im_func;var c=g.im_preargs;var b=g.im_self;var a=MochiKit.Base;if(typeof(g)=="function"&&typeof(g.apply)=="undefined"){g=a._wrapDumbFunction(g)}if(typeof(d)!="function"){d=g}if(typeof(f)!="undefined"){b=f}if(typeof(c)=="undefined"){c=[]}else{c=c.slice()}a.extend(c,arguments,2);var e=function(){var j=arguments;var k=arguments.callee;if(k.im_preargs.length>0){j=a.concat(k.im_preargs,j)}var h=k.im_self;if(!h){h=this}return k.im_func.apply(h,j)};e.im_self=b;e.im_func=d;e.im_preargs=c;return e},bindMethods:function(a){var d=MochiKit.Base.bind;for(var b in a){var c=a[b];if(typeof(c)=="function"){a[b]=d(c,a)}}},registerComparator:function(d,c,b,a){MochiKit.Base.comparatorRegistry.register(d,c,b,a)},_primitives:{"boolean":true,string:true,number:true},compare:function(f,d){if(f==d){return 0}var h=(typeof(f)=="undefined"||f===null);var g=(typeof(d)=="undefined"||d===null);if(h&&g){return 0}else{if(h){return -1}else{if(g){return 1}}}var c=MochiKit.Base;var k=c._primitives;if(!(typeof(f) in k&&typeof(d) in k)){try{return c.comparatorRegistry.match(f,d)}catch(l){if(l!=c.NotFound){throw l}}}if(f<d){return -1}else{if(f>d){return 1}}var j=c.repr;throw new TypeError(j(f)+" and "+j(d)+" can not be compared")},compareDateLike:function(d,c){return MochiKit.Base.compare(d.getTime(),c.getTime())},compareArrayLike:function(f,d){var e=MochiKit.Base.compare;var c=f.length;var j=0;if(c>d.length){j=1;c=d.length}else{if(c<d.length){j=-1}}for(var g=0;g<c;g++){var h=e(f[g],d[g]);if(h){return h}}return j},registerRepr:function(d,c,b,a){MochiKit.Base.reprRegistry.register(d,c,b,a)},repr:function(d){if(typeof(d)=="undefined"){return"undefined"}else{if(d===null){return"null"}}try{if(typeof(d.__repr__)=="function"){return d.__repr__()}else{if(typeof(d.repr)=="function"&&d.repr!=arguments.callee){return d.repr()}}return MochiKit.Base.reprRegistry.match(d)}catch(c){if(typeof(d.NAME)=="string"&&(d.toString==Function.prototype.toString||d.toString==Object.prototype.toString)){return d.NAME}}try{var b=(d+"")}catch(c){return"["+typeof(d)+"]"}if(typeof(d)=="function"){b=b.replace(/^\s+/,"").replace(/\s+/g," ");var a=b.indexOf("{");if(a!=-1){b=b.substr(0,a)+"{...}"}}return b},reprArrayLike:function(b){var a=MochiKit.Base;return"["+a.map(a.repr,b).join(", ")+"]"},reprString:function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},reprNumber:function(a){return a+""},registerJSON:function(d,c,b,a){MochiKit.Base.jsonRegistry.register(d,c,b,a)},evalJSON:function(){return eval("("+MochiKit.Base._filterJSON(arguments[0])+")")},_filterJSON:function(b){var a=b.match(/^\s*\/\*(.*)\*\/\s*$/);if(a){return a[1]}return b},serializeJSON:function(c){var b=typeof(c);if(b=="number"||b=="boolean"){return c+""}else{if(c===null){return"null"}}var g=MochiKit.Base;var h=g.reprString;if(b=="string"){return h(c)}var r=arguments.callee;var f;if(typeof(c.__json__)=="function"){f=c.__json__();if(c!==f){return r(f)}}if(typeof(c.json)=="function"){f=c.json();if(c!==f){return r(f)}}if(b!="function"&&typeof(c.length)=="number"){var q=[];for(var l=0;l<c.length;l++){var d=r(c[l]);if(typeof(d)!="string"){d="undefined"}q.push(d)}return"["+q.join(", ")+"]"}try{f=g.jsonRegistry.match(c);if(c!==f){return r(f)}}catch(n){if(n!=g.NotFound){throw n}}if(b=="undefined"){throw new TypeError("undefined can not be serialized as JSON")}if(b=="function"){return null}q=[];for(var j in c){var a;if(typeof(j)=="number"){a='"'+j+'"'}else{if(typeof(j)=="string"){a=h(j)}else{continue}}d=r(c[j]);if(typeof(d)!="string"){continue}q.push(a+":"+d)}return"{"+q.join(", ")+"}"},objEqual:function(d,c){return(MochiKit.Base.compare(d,c)===0)},arrayEqual:function(b,a){if(b.length!=a.length){return false}return(MochiKit.Base.compare(b,a)===0)},concat:function(){var a=[];var c=MochiKit.Base.extend;for(var b=0;b<arguments.length;b++){c(a,arguments[b])}return a},keyComparator:function(c){var b=MochiKit.Base;var a=b.compare;if(arguments.length==1){return function(f,e){return a(f[c],e[c])}}var d=b.extend(null,arguments);return function(f,e){var j=0;for(var h=0;(j===0)&&(h<d.length);h++){var g=d[h];j=a(f[g],e[g])}return j}},reverseKeyComparator:function(b){var a=MochiKit.Base.keyComparator.apply(this,arguments);return function(d,c){return a(c,d)}},partial:function(b){var a=MochiKit.Base;return a.bind.apply(this,a.extend([b,undefined],arguments,1))},listMinMax:function(b,a){if(a.length===0){return null}var f=a[0];var e=MochiKit.Base.compare;for(var c=1;c<a.length;c++){var d=a[c];if(e(d,f)==b){f=d}}return f},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(a,e,d,b){if(typeof(b)=="undefined"||b===null){b=a.length}if(typeof(d)=="undefined"||d===null){d=0}for(var c=d;c<b;c++){if(a[c]===e){return c}}return -1},mean:function(){var e=0;var b=MochiKit.Base;var c=b.extend(null,arguments);var a=c.length;while(c.length){var f=c.shift();if(f&&typeof(f)=="object"&&typeof(f.length)=="number"){a+=f.length-1;for(var d=f.length-1;d>=0;d--){e+=f[d]}}else{e+=f}}if(a<=0){throw new TypeError("mean() requires at least one argument")}return e/a},median:function(){var b=MochiKit.Base.flattenArguments(arguments);if(b.length===0){throw new TypeError("median() requires at least one argument")}b.sort(compare);if(b.length%2==0){var a=b.length/2;return(b[a]+b[a-1])/2}else{return b[(b.length-1)/2]}},findValue:function(a,f,e,b){if(typeof(b)=="undefined"||b===null){b=a.length}if(typeof(e)=="undefined"||e===null){e=0}var d=MochiKit.Base.compare;for(var c=e;c<b;c++){if(d(a[c],f)===0){return c}}return -1},nodeWalk:function(e,d){var c=[e];var b=MochiKit.Base.extend;while(c.length){var a=d(c.shift());if(a){b(c,a)}}},nameFunctions:function(a){var c=a.NAME;if(typeof(c)=="undefined"){c=""}else{c=c+"."}for(var b in a){var f=a[b];if(typeof(f)=="function"&&typeof(f.NAME)=="undefined"){try{f.NAME=c+b}catch(d){}}}},queryString:function(c,a){if(typeof(MochiKit.DOM)!="undefined"&&arguments.length==1&&(typeof(c)=="string"||(typeof(c.nodeType)!="undefined"&&c.nodeType>0))){var h=MochiKit.DOM.formContents(c);c=h[0];a=h[1]}else{if(arguments.length==1){if(typeof(c.length)=="number"&&c.length==2){return arguments.callee(c[0],c[1])}var b=c;c=[];a=[];for(var d in b){var l=b[d];if(typeof(l)=="function"){continue}else{if(MochiKit.Base.isArrayLike(l)){for(var e=0;e<l.length;e++){c.push(d);a.push(l[e])}}else{c.push(d);a.push(l)}}}}}var f=[];var g=Math.min(c.length,a.length);var j=MochiKit.Base.urlEncode;for(var e=0;e<g;e++){l=a[e];if(typeof(l)!="undefined"&&l!==null){f.push(j(c[e])+"="+j(l))}}return f.join("&")},parseQueryString:function(j,h){var c=(j.charAt(0)=="?")?j.substring(1):j;var g=c.replace(/\+/g,"%20").split(/\&amp\;|\&\#38\;|\&#x26;|\&/);var b={};var k;if(typeof(decodeURIComponent)!="undefined"){k=decodeURIComponent}else{k=unescape}if(h){for(var e=0;e<g.length;e++){var d=g[e].split("=");var a=k(d.shift());if(!a){continue}var f=b[a];if(!(f instanceof Array)){f=[];b[a]=f}f.push(k(d.join("=")))}}else{for(e=0;e<g.length;e++){d=g[e].split("=");var a=d.shift();if(!a){continue}b[k(a)]=k(d.join("="))}}return b}});MochiKit.Base.AdapterRegistry=function(){this.pairs=[]};MochiKit.Base.AdapterRegistry.prototype={register:function(c,b,d,a){if(a){this.pairs.unshift([c,b,d])}else{this.pairs.push([c,b,d])}},match:function(){for(var a=0;a<this.pairs.length;a++){var b=this.pairs[a];if(b[1].apply(this,arguments)){return b[2].apply(this,arguments)}}throw MochiKit.Base.NotFound},unregister:function(a){for(var b=0;b<this.pairs.length;b++){var c=this.pairs[b];if(c[0]==a){this.pairs.splice(b,1);return true}}return false}};MochiKit.Base.EXPORT=["flattenArray","noop","camelize","counter","clone","extend","update","updatetree","setdefault","keys","values","items","NamedError","operator","forwardCall","itemgetter","typeMatcher","isCallable","isUndefined","isUndefinedOrNull","isNull","isEmpty","isNotEmpty","isArrayLike","isDateLike","xmap","map","xfilter","filter","methodcaller","compose","bind","bindMethods","NotFound","AdapterRegistry","registerComparator","compare","registerRepr","repr","objEqual","arrayEqual","concat","keyComparator","reverseKeyComparator","partial","merge","listMinMax","listMax","listMin","objMax","objMin","nodeWalk","zip","urlEncode","queryString","serializeJSON","registerJSON","evalJSON","parseQueryString","findValue","findIdentical","flattenArguments","method","average","mean","median"];MochiKit.Base.EXPORT_OK=["nameFunctions","comparatorRegistry","reprRegistry","jsonRegistry","compareDateLike","compareArrayLike","reprArrayLike","reprString","reprNumber"];MochiKit.Base._exportSymbols=function(c,d){if(!MochiKit.__export__){return}var b=d.EXPORT_TAGS[":all"];for(var a=0;a<b.length;a++){c[b[a]]=d[b[a]]}};MochiKit.Base.__new__=function(){var a=this;a.noop=a.operator.identity;a.forward=a.forwardCall;a.find=a.findValue;if(typeof(encodeURIComponent)!="undefined"){a.urlEncode=function(c){return encodeURIComponent(c).replace(/\'/g,"%27")}}else{a.urlEncode=function(c){return escape(c).replace(/\+/g,"%2B").replace(/\"/g,"%22").rval.replace(/\'/g,"%27")}}a.NamedError=function(c){this.message=c;this.name=c};a.NamedError.prototype=new Error();a.update(a.NamedError.prototype,{repr:function(){if(this.message&&this.message!=this.name){return this.name+"("+a.repr(this.message)+")"}else{return this.name+"()"}},toString:a.forwardCall("repr")});a.NotFound=new a.NamedError("MochiKit.Base.NotFound");a.listMax=a.partial(a.listMinMax,1);a.listMin=a.partial(a.listMinMax,-1);a.isCallable=a.typeMatcher("function");a.isUndefined=a.typeMatcher("undefined");a.merge=a.partial(a.update,null);a.zip=a.partial(a.map,null);a.average=a.mean;a.comparatorRegistry=new a.AdapterRegistry();a.registerComparator("dateLike",a.isDateLike,a.compareDateLike);a.registerComparator("arrayLike",a.isArrayLike,a.compareArrayLike);a.reprRegistry=new a.AdapterRegistry();a.registerRepr("arrayLike",a.isArrayLike,a.reprArrayLike);a.registerRepr("string",a.typeMatcher("string"),a.reprString);a.registerRepr("numbers",a.typeMatcher("number","boolean"),a.reprNumber);a.jsonRegistry=new a.AdapterRegistry();var b=a.concat(a.EXPORT,a.EXPORT_OK);a.EXPORT_TAGS={":common":a.concat(a.EXPORT_OK),":all":b};a.nameFunctions(this)};MochiKit.Base.__new__();if(MochiKit.__export__){compare=MochiKit.Base.compare;compose=MochiKit.Base.compose;serializeJSON=MochiKit.Base.serializeJSON;mean=MochiKit.Base.mean;median=MochiKit.Base.median}MochiKit.Base._exportSymbols(this,MochiKit.Base);MochiKit.Base._deps("Iter",["Base"]);MochiKit.Iter.NAME="MochiKit.Iter";MochiKit.Iter.VERSION="1.4";MochiKit.Base.update(MochiKit.Iter,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},registerIteratorFactory:function(d,c,b,a){MochiKit.Iter.iteratorRegistry.register(d,c,b,a)},iter:function(f,d){var b=MochiKit.Iter;if(arguments.length==2){return b.takewhile(function(e){return e!=d},f)}if(typeof(f.next)=="function"){return f}else{if(typeof(f.iter)=="function"){return f.iter()}}try{return b.iteratorRegistry.match(f)}catch(c){var a=MochiKit.Base;if(c==a.NotFound){c=new TypeError(typeof(f)+": "+a.repr(f)+" is not iterable")}throw c}},count:function(b){if(!b){b=0}var a=MochiKit.Base;return{repr:function(){return"count("+b+")"},toString:a.forwardCall("repr"),next:a.counter(b)}},cycle:function(e){var c=MochiKit.Iter;var b=MochiKit.Base;var a=[];var d=c.iter(e);return{repr:function(){return"cycle(...)"},toString:b.forwardCall("repr"),next:function(){try{var h=d.next();a.push(h);return h}catch(g){if(g!=c.StopIteration){throw g}if(a.length===0){this.next=function(){throw c.StopIteration}}else{var f=-1;this.next=function(){f=(f+1)%a.length;return a[f]}}return this.next()}}}},repeat:function(b,c){var a=MochiKit.Base;if(typeof(c)=="undefined"){return{repr:function(){return"repeat("+a.repr(b)+")"},toString:a.forwardCall("repr"),next:function(){return b}}}return{repr:function(){return"repeat("+a.repr(b)+", "+c+")"},toString:a.forwardCall("repr"),next:function(){if(c<=0){throw MochiKit.Iter.StopIteration}c-=1;return b}}},next:function(a){return a.next()},izip:function(e,d){var a=MochiKit.Base;var b=MochiKit.Iter;var c=b.next;var f=a.map(b.iter,arguments);return{repr:function(){return"izip(...)"},toString:a.forwardCall("repr"),next:function(){return a.map(c,f)}}},ifilter:function(c,b){var a=MochiKit.Base;b=MochiKit.Iter.iter(b);if(c===null){c=a.operator.truth}return{repr:function(){return"ifilter(...)"},toString:a.forwardCall("repr"),next:function(){while(true){var d=b.next();if(c(d)){return d}}return undefined}}},ifilterfalse:function(c,b){var a=MochiKit.Base;b=MochiKit.Iter.iter(b);if(c===null){c=a.operator.truth}return{repr:function(){return"ifilterfalse(...)"},toString:a.forwardCall("repr"),next:function(){while(true){var d=b.next();if(!c(d)){return d}}return undefined}}},islice:function(d){var c=MochiKit.Iter;var b=MochiKit.Base;d=c.iter(d);var a=0;var f=0;var g=1;var e=-1;if(arguments.length==2){f=arguments[1]}else{if(arguments.length==3){a=arguments[1];f=arguments[2]}else{a=arguments[1];f=arguments[2];g=arguments[3]}}return{repr:function(){return"islice("+["...",a,f,g].join(", ")+")"},toString:b.forwardCall("repr"),next:function(){var h;while(e<a){h=d.next();e++}if(a>=f){throw c.StopIteration}a+=g;return h}}},imap:function(b,h,e){var a=MochiKit.Base;var c=MochiKit.Iter;var g=a.map(c.iter,a.extend(null,arguments,1));var f=a.map;var d=c.next;return{repr:function(){return"imap(...)"},toString:a.forwardCall("repr"),next:function(){return b.apply(this,f(d,g))}}},applymap:function(b,d,c){d=MochiKit.Iter.iter(d);var a=MochiKit.Base;return{repr:function(){return"applymap(...)"},toString:a.forwardCall("repr"),next:function(){return b.apply(c,d.next())}}},chain:function(e,d){var c=MochiKit.Iter;var a=MochiKit.Base;if(arguments.length==1){return c.iter(arguments[0])}var b=a.map(c.iter,arguments);return{repr:function(){return"chain(...)"},toString:a.forwardCall("repr"),next:function(){while(b.length>1){try{var g=b[0].next();return g}catch(h){if(h!=c.StopIteration){throw h}b.shift();var g=b[0].next();return g}}if(b.length==1){var f=b.shift();this.next=a.bind("next",f);return this.next()}throw c.StopIteration}}},takewhile:function(c,b){var a=MochiKit.Iter;b=a.iter(b);return{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var d=b.next();if(!c(d)){this.next=function(){throw a.StopIteration};this.next()}return d}}},dropwhile:function(c,b){b=MochiKit.Iter.iter(b);var a=MochiKit.Base;var d=a.bind;return{repr:function(){return"dropwhile(...)"},toString:a.forwardCall("repr"),next:function(){while(true){var e=b.next();if(!c(e)){break}}this.next=d("next",b);return e}}},_tee:function(e,d,c){d.pos[e]=-1;var a=MochiKit.Base;var b=a.listMin;return{repr:function(){return"tee("+e+", ...)"},toString:a.forwardCall("repr"),next:function(){var g;var f=d.pos[e];if(f==d.max){g=c.next();d.deque.push(g);d.max+=1;d.pos[e]+=1}else{g=d.deque[f-d.min];d.pos[e]+=1;if(f==d.min&&b(d.pos)!=d.min){d.min+=1;d.deque.shift()}}return g}}},tee:function(d,g){var f=[];var e={pos:[],deque:[],max:-1,min:-1};if(arguments.length==1||typeof(g)=="undefined"||g===null){g=2}var b=MochiKit.Iter;d=b.iter(d);var a=b._tee;for(var c=0;c<g;c++){f.push(a(c,e,d))}return f},list:function(f){var d;if(f instanceof Array){return f.slice()}if(typeof(f)=="function"&&!(f instanceof Function)&&typeof(f.length)=="number"){d=[];for(var b=0;b<f.length;b++){d.push(f[b])}return d}var a=MochiKit.Iter;f=a.iter(f);var d=[];var g;try{while(true){g=f.next();d.push(g)}}catch(c){if(c!=a.StopIteration){throw c}return d}return undefined},reduce:function(d,g,f){var c=0;var a=f;var b=MochiKit.Iter;g=b.iter(g);if(arguments.length<3){try{a=g.next()}catch(h){if(h==b.StopIteration){h=new TypeError("reduce() of empty sequence with no initial value")}throw h}c++}try{while(true){a=d(a,g.next())}}catch(h){if(h!=b.StopIteration){throw h}}return a},range:function(){var b=0;var a=0;var c=1;if(arguments.length==1){a=arguments[0]}else{if(arguments.length==2){b=arguments[0];a=arguments[1]}else{if(arguments.length==3){b=arguments[0];a=arguments[1];c=arguments[2]}else{throw new TypeError("range() takes 1, 2, or 3 arguments!")}}}if(c===0){throw new TypeError("range() step must not be 0")}return{next:function(){if((c>0&&b>=a)||(c<0&&b<=a)){throw MochiKit.Iter.StopIteration}var d=b;b+=c;return d},repr:function(){return"range("+[b,a,c].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}},sum:function(b,f){if(typeof(f)=="undefined"||f===null){f=0}var a=f;var c=MochiKit.Iter;b=c.iter(b);try{while(true){a+=b.next()}}catch(d){if(d!=c.StopIteration){throw d}}return a},exhaust:function(a){var b=MochiKit.Iter;a=b.iter(a);try{while(true){a.next()}}catch(c){if(c!=b.StopIteration){throw c}}},forEach:function(g,d,b){var a=MochiKit.Base;if(arguments.length>2){d=a.bind(d,b)}if(a.isArrayLike(g)){try{for(var c=0;c<g.length;c++){d(g[c])}}catch(f){if(f!=MochiKit.Iter.StopIteration){throw f}}}else{b=MochiKit.Iter;b.exhaust(b.imap(d,g))}},every:function(c,b){var a=MochiKit.Iter;try{a.ifilterfalse(b,c).next();return false}catch(d){if(d!=a.StopIteration){throw d}return true}},sorted:function(a,b){var c=MochiKit.Iter.list(a);if(arguments.length==1){b=MochiKit.Base.compare}c.sort(b);return c},reversed:function(a){var b=MochiKit.Iter.list(a);b.reverse();return b},some:function(b,c){var a=MochiKit.Iter;try{a.ifilter(c,b).next();return true}catch(d){if(d!=a.StopIteration){throw d}return false}},iextend:function(b,a){if(MochiKit.Base.isArrayLike(a)){for(var d=0;d<a.length;d++){b.push(a[d])}}else{var c=MochiKit.Iter;a=c.iter(a);try{while(true){b.push(a.next())}}catch(f){if(f!=c.StopIteration){throw f}}}return b},groupby:function(l,j){var c=MochiKit.Base;var n=MochiKit.Iter;if(arguments.length<2){j=c.operator.identity}l=n.iter(l);var e=undefined;var d=undefined;var h;function a(){h=l.next();d=j(h)}function b(){var k=h;h=undefined;return k}var f=true;var g=c.compare;return{repr:function(){return"groupby(...)"},next:function(){while(g(d,e)===0){a();if(f){f=false;break}}e=d;return[d,{next:function(){if(h==undefined){a()}if(g(d,e)!==0){throw n.StopIteration}return b()}}]}}},groupby_as_array:function(l,k){var a=MochiKit.Base;var o=MochiKit.Iter;if(arguments.length<2){k=a.operator.identity}l=o.iter(l);var j=[];var h=true;var g;var d=a.compare;while(true){try{var c=l.next();var n=k(c)}catch(f){if(f==o.StopIteration){break}throw f}if(h||d(n,g)!==0){var b=[];j.push([n,b])}b.push(c);h=false;g=n}return j},arrayLikeIter:function(b){var a=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(a>=b.length){throw MochiKit.Iter.StopIteration}return b[a++]}}},hasIterateNext:function(a){return(a&&typeof(a.iterateNext)=="function")},iterateNextIter:function(a){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var b=a.iterateNext();if(b===null||b===undefined){throw MochiKit.Iter.StopIteration}return b}}}});MochiKit.Iter.EXPORT_OK=["iteratorRegistry","arrayLikeIter","hasIterateNext","iterateNextIter"];MochiKit.Iter.EXPORT=["StopIteration","registerIteratorFactory","iter","count","cycle","repeat","next","izip","ifilter","ifilterfalse","islice","imap","applymap","chain","takewhile","dropwhile","tee","list","reduce","range","sum","exhaust","forEach","every","sorted","reversed","some","iextend","groupby","groupby_as_array"];MochiKit.Iter.__new__=function(){var a=MochiKit.Base;if(typeof(StopIteration)!="undefined"){this.StopIteration=StopIteration}else{this.StopIteration=new a.NamedError("StopIteration")}this.iteratorRegistry=new a.AdapterRegistry();this.registerIteratorFactory("arrayLike",a.isArrayLike,this.arrayLikeIter);this.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter);this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};MochiKit.Iter.__new__();if(MochiKit.__export__){reduce=MochiKit.Iter.reduce}MochiKit.Base._exportSymbols(this,MochiKit.Iter);MochiKit.Base._deps("Logging",["Base"]);MochiKit.Logging.NAME="MochiKit.Logging";MochiKit.Logging.VERSION="1.4";MochiKit.Logging.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Logging.toString=function(){return this.__repr__()};MochiKit.Logging.EXPORT=["LogLevel","LogMessage","Logger","alertListener","logger","log","logError","logDebug","logFatal","logWarning"];MochiKit.Logging.EXPORT_OK=["logLevelAtLeast","isLogMessage","compareLogMessage"];MochiKit.Logging.LogMessage=function(a,b,c){this.num=a;this.level=b;this.info=c;this.timestamp=new Date()};MochiKit.Logging.LogMessage.prototype={repr:function(){var a=MochiKit.Base;return"LogMessage("+a.map(a.repr,[this.num,this.level,this.info]).join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")};MochiKit.Base.update(MochiKit.Logging,{logLevelAtLeast:function(b){var a=MochiKit.Logging;if(typeof(b)=="string"){b=a.LogLevel[b]}return function(d){var c=d.level;if(typeof(c)=="string"){c=a.LogLevel[c]}return c>=b}},isLogMessage:function(){var a=MochiKit.Logging.LogMessage;for(var b=0;b<arguments.length;b++){if(!(arguments[b] instanceof a)){return false}}return true},compareLogMessage:function(d,c){return MochiKit.Base.compare([d.level,d.info],[c.level,c.info])},alertListener:function(a){alert("num: "+a.num+"\nlevel: "+a.level+"\ninfo: "+a.info.join(" "))}});MochiKit.Logging.Logger=function(a){this.counter=0;if(typeof(a)=="undefined"||a===null){a=-1}this.maxSize=a;this._messages=[];this.listeners={};this.useNativeConsole=false};MochiKit.Logging.Logger.prototype={clear:function(){this._messages.splice(0,this._messages.length)},logToConsole:function(a){if(typeof(window)!="undefined"&&window.console&&window.console.log){window.console.log(a.replace(/%/g,"\uff05"))}else{if(typeof(opera)!="undefined"&&opera.postError){opera.postError(a)}else{if(typeof(printfire)=="function"){printfire(a)}else{if(typeof(Debug)!="undefined"&&Debug.writeln){Debug.writeln(a)}else{if(typeof(debug)!="undefined"&&debug.trace){debug.trace(a)}}}}}},dispatchListeners:function(c){for(var a in this.listeners){var b=this.listeners[a];if(b.ident!=a||(b[0]&&!b[0](c))){continue}b[1](c)}},addListener:function(d,c,b){if(typeof(c)=="string"){c=MochiKit.Logging.logLevelAtLeast(c)}var a=[c,b];a.ident=d;this.listeners[d]=a},removeListener:function(a){delete this.listeners[a]},baseLog:function(c,b){var a=new MochiKit.Logging.LogMessage(this.counter,c,MochiKit.Base.extend(null,arguments,1));this._messages.push(a);this.dispatchListeners(a);if(this.useNativeConsole){this.logToConsole(a.level+": "+a.info.join(" "))}this.counter+=1;while(this.maxSize>=0&&this._messages.length>this.maxSize){this._messages.shift()}},getMessages:function(b){var a=0;if(!(typeof(b)=="undefined"||b===null)){a=Math.max(0,this._messages.length-b)}return this._messages.slice(a)},getMessageText:function(c){if(typeof(c)=="undefined"||c===null){c=30}var b=this.getMessages(c);if(b.length){var a=map(function(d){return"\n  ["+d.num+"] "+d.level+": "+d.info.join(" ")},b);a.unshift("LAST "+b.length+" MESSAGES:");return a.join("")}return""},debuggingBookmarklet:function(a){if(typeof(MochiKit.LoggingPane)=="undefined"){alert(this.getMessageText())}else{MochiKit.LoggingPane.createLoggingPane(a||false)}}};MochiKit.Logging.__new__=function(){this.LogLevel={ERROR:40,FATAL:50,WARNING:30,INFO:20,DEBUG:10};var a=MochiKit.Base;a.registerComparator("LogMessage",this.isLogMessage,this.compareLogMessage);var f=a.partial;var d=this.Logger;var e=d.prototype.baseLog;a.update(this.Logger.prototype,{debug:f(e,"DEBUG"),log:f(e,"INFO"),error:f(e,"ERROR"),fatal:f(e,"FATAL"),warning:f(e,"WARNING")});var c=this;var b=function(g){return function(){c.logger[g].apply(c.logger,arguments)}};this.log=b("log");this.logError=b("error");this.logDebug=b("debug");this.logFatal=b("fatal");this.logWarning=b("warning");this.logger=new d();this.logger.useNativeConsole=true;this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};if(typeof(printfire)=="undefined"&&typeof(document)!="undefined"&&document.createEvent&&typeof(dispatchEvent)!="undefined"){printfire=function(){printfire.args=arguments;var a=document.createEvent("Events");a.initEvent("printfire",false,true);dispatchEvent(a)}}MochiKit.Logging.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Logging);MochiKit.Base._deps("DateTime",["Base"]);MochiKit.DateTime.NAME="MochiKit.DateTime";MochiKit.DateTime.VERSION="1.4";MochiKit.DateTime.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.DateTime.toString=function(){return this.__repr__()};MochiKit.DateTime.isoDate=function(c){c=c+"";if(typeof(c)!="string"||c.length===0){return null}var b=c.split("-");if(b.length===0){return null}var a=new Date();a.setFullYear(b[0]);a.setMonth(b[1]-1);a.setDate(b[2]);return a};MochiKit.DateTime._isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;MochiKit.DateTime.isoTimestamp=function(g){g=g+"";if(typeof(g)!="string"||g.length===0){return null}var f=g.match(MochiKit.DateTime._isoRegexp);if(typeof(f)=="undefined"||f===null){return null}var h,k,j,b,c,d,a;h=parseInt(f[1],10);if(typeof(f[2])=="undefined"||f[2]===""){return new Date(h)}k=parseInt(f[2],10)-1;j=parseInt(f[3],10);if(typeof(f[4])=="undefined"||f[4]===""){return new Date(h,k,j)}b=parseInt(f[4],10);c=parseInt(f[5],10);d=(typeof(f[6])!="undefined"&&f[6]!=="")?parseInt(f[6],10):0;if(typeof(f[7])!="undefined"&&f[7]!==""){a=Math.round(1000*parseFloat("0."+f[7]))}else{a=0}if((typeof(f[8])=="undefined"||f[8]==="")&&(typeof(f[9])=="undefined"||f[9]==="")){return new Date(h,k,j,b,c,d,a)}var e;if(typeof(f[9])!="undefined"&&f[9]!==""){e=parseInt(f[10],10)*3600000;if(typeof(f[11])!="undefined"&&f[11]!==""){e+=parseInt(f[11],10)*60000}if(f[9]=="-"){e=-e}}else{e=0}return new Date(Date.UTC(h,k,j,b,c,d,a)-e)};MochiKit.DateTime.toISOTime=function(c,b){if(typeof(c)=="undefined"||c===null){return null}var e=c.getHours();var f=c.getMinutes();var d=c.getSeconds();var a=[((b&&(e<10))?"0"+e:e),((f<10)?"0"+f:f),((d<10)?"0"+d:d)];return a.join(":")};MochiKit.DateTime.toISOTimestamp=function(b,d){if(typeof(b)=="undefined"||b===null){return null}var a=d?"T":" ";var c=d?"Z":"";if(d){b=new Date(b.getTime()+(b.getTimezoneOffset()*60000))}return MochiKit.DateTime.toISODate(b)+a+MochiKit.DateTime.toISOTime(b,d)+c};MochiKit.DateTime.toISODate=function(a){if(typeof(a)=="undefined"||a===null){return null}var c=MochiKit.DateTime._padTwo;var b=MochiKit.DateTime._padFour;return[b(a.getFullYear()),c(a.getMonth()+1),c(a.getDate())].join("-")};MochiKit.DateTime.americanDate=function(c){c=c+"";if(typeof(c)!="string"||c.length===0){return null}var b=c.split("/");return new Date(b[2],b[0]-1,b[1])};MochiKit.DateTime._padTwo=function(a){return(a>9)?a:"0"+a};MochiKit.DateTime._padFour=function(a){switch(a.toString().length){case 1:return"000"+a;break;case 2:return"00"+a;break;case 3:return"0"+a;break;case 4:default:return a}};MochiKit.DateTime.toPaddedAmericanDate=function(b){if(typeof(b)=="undefined"||b===null){return null}var a=MochiKit.DateTime._padTwo;return[a(b.getMonth()+1),a(b.getDate()),b.getFullYear()].join("/")};MochiKit.DateTime.toAmericanDate=function(a){if(typeof(a)=="undefined"||a===null){return null}return[a.getMonth()+1,a.getDate(),a.getFullYear()].join("/")};MochiKit.DateTime.EXPORT=["isoDate","isoTimestamp","toISOTime","toISOTimestamp","toISODate","americanDate","toPaddedAmericanDate","toAmericanDate"];MochiKit.DateTime.EXPORT_OK=[];MochiKit.DateTime.EXPORT_TAGS={":common":MochiKit.DateTime.EXPORT,":all":MochiKit.DateTime.EXPORT};MochiKit.DateTime.__new__=function(){var b=this.NAME+".";for(var a in this){var d=this[a];if(typeof(d)=="function"&&typeof(d.NAME)=="undefined"){try{d.NAME=b+a}catch(c){}}}};MochiKit.DateTime.__new__();if(typeof(MochiKit.Base)!="undefined"){MochiKit.Base._exportSymbols(this,MochiKit.DateTime)}else{(function(d,a){if((typeof(JSAN)=="undefined"&&typeof(dojo)=="undefined")||(MochiKit.__export__===false)){var c=a.EXPORT_TAGS[":all"];for(var b=0;b<c.length;b++){d[c[b]]=a[c[b]]}}})(this,MochiKit.DateTime)}MochiKit.Base._deps("Format",["Base"]);MochiKit.Format.NAME="MochiKit.Format";MochiKit.Format.VERSION="1.4";MochiKit.Format.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Format.toString=function(){return this.__repr__()};MochiKit.Format._numberFormatter=function(j,h,g,f,e,d,c,b,a){return function(n){n=parseFloat(n);if(typeof(n)=="undefined"||n===null||isNaN(n)){return j}var q=h;var o=g;if(n<0){n=-n}else{q=q.replace(/-/,"")}var s=arguments.callee;var l=MochiKit.Format.formatLocale(f);if(e){n=n*100;o=l.percent+o}n=MochiKit.Format.roundToFixed(n,d);var u=n.split(/\./);var t=u[0];var k=(u.length==1)?"":u[1];var r="";while(t.length<c){t="0"+t}if(b){while(t.length>b){var m=t.length-b;r=l.separator+t.substring(m,t.length)+r;t=t.substring(0,m)}}r=t+r;if(d>0){while(k.length<a){k=k+"0"}r=r+l.decimal+k}return q+r+o}};MochiKit.Format.numberFormatter=function(s,r,o){if(typeof(r)=="undefined"){r=""}var l=s.match(/((?:[0#]+,)?[0#]+)(?:\.([0#]+))?(%)?/);if(!l){throw TypeError("Invalid pattern")}var j=s.substr(0,l.index);var g=s.substr(l.index+l[0].length);if(j.search(/-/)==-1){j=j+"-"}var f=l[1];var b=(typeof(l[2])=="string"&&l[2]!="")?l[2]:"";var d=(typeof(l[3])=="string"&&l[3]!="");var t=f.split(/,/);var q;if(typeof(o)=="undefined"){o="default"}if(t.length==1){q=null}else{q=t[1].length}var n=f.length-f.replace(/0/g,"").length;var k=b.length-b.replace(/0/g,"").length;var h=b.length;var u=MochiKit.Format._numberFormatter(r,j,g,o,d,h,n,q,k);var e=MochiKit.Base;if(e){var c=arguments.callee;var a=e.concat(arguments);u.repr=function(){return[self.NAME,"(",map(e.repr,a).join(", "),")"].join("")}}return u};MochiKit.Format.formatLocale=function(a){if(typeof(a)=="undefined"||a===null){a="default"}if(typeof(a)=="string"){var b=MochiKit.Format.LOCALE[a];if(typeof(b)=="string"){b=arguments.callee(b);MochiKit.Format.LOCALE[a]=b}return b}else{return a}};MochiKit.Format.twoDigitAverage=function(c,b){if(b){var a=c/b;if(!isNaN(a)){return MochiKit.Format.twoDigitFloat(c/b)}}return"0"};MochiKit.Format.twoDigitFloat=function(e){var a=(e<0?"-":"");var d=Math.floor(Math.abs(e)*100).toString();if(d=="0"){return d}if(d.length<3){if(d.length==1){d="0"+d}while(d.charAt(d.length-1)=="0"){d=d.substring(0,d.length-1)}return a+"0."+d}var c=a+d.substring(0,d.length-2);var b=d.substring(d.length-2,d.length);if(b=="00"){return c}else{if(b.charAt(1)=="0"){return c+"."+b.charAt(0)}else{return c+"."+b}}};MochiKit.Format.lstrip=function(b,a){b=b+"";if(typeof(b)!="string"){return null}if(!a){return b.replace(/^\s+/,"")}else{return b.replace(new RegExp("^["+a+"]+"),"")}};MochiKit.Format.rstrip=function(b,a){b=b+"";if(typeof(b)!="string"){return null}if(!a){return b.replace(/\s+$/,"")}else{return b.replace(new RegExp("["+a+"]+$"),"")}};MochiKit.Format.strip=function(c,b){var a=MochiKit.Format;return a.rstrip(a.lstrip(c,b),b)};MochiKit.Format.truncToFixed=function(b,a){b=Math.floor(b*Math.pow(10,a));var c=(b*Math.pow(10,-a)).toFixed(a);if(c.charAt(0)=="."){c="0"+c}return c};MochiKit.Format.roundToFixed=function(b,a){return MochiKit.Format.truncToFixed(b+0.5*Math.pow(10,-a),a)};MochiKit.Format.percentFormat=function(a){return MochiKit.Format.twoDigitFloat(100*a)+"%"};MochiKit.Format.EXPORT=["truncToFixed","roundToFixed","numberFormatter","formatLocale","twoDigitAverage","twoDigitFloat","percentFormat","lstrip","rstrip","strip"];MochiKit.Format.LOCALE={en_US:{separator:",",decimal:".",percent:"%"},de_DE:{separator:".",decimal:",",percent:"%"},pt_BR:{separator:".",decimal:",",percent:"%"},fr_FR:{separator:" ",decimal:",",percent:"%"},"default":"en_US"};MochiKit.Format.EXPORT_OK=[];MochiKit.Format.EXPORT_TAGS={":all":MochiKit.Format.EXPORT,":common":MochiKit.Format.EXPORT};MochiKit.Format.__new__=function(){var c=this.NAME+".";var b,a,f;for(b in this.LOCALE){f=this.LOCALE[b];if(typeof(f)=="object"){f.repr=function(){return this.NAME};f.NAME=c+"LOCALE."+b}}for(b in this){f=this[b];if(typeof(f)=="function"&&typeof(f.NAME)=="undefined"){try{f.NAME=c+b}catch(d){}}}};MochiKit.Format.__new__();if(typeof(MochiKit.Base)!="undefined"){MochiKit.Base._exportSymbols(this,MochiKit.Format)}else{(function(d,c){if((typeof(JSAN)=="undefined"&&typeof(dojo)=="undefined")||(MochiKit.__export__===false)){var b=c.EXPORT_TAGS[":all"];for(var a=0;a<b.length;a++){d[b[a]]=c[b[a]]}}})(this,MochiKit.Format)}MochiKit.Base._deps("Async",["Base"]);MochiKit.Async.NAME="MochiKit.Async";MochiKit.Async.VERSION="1.4";MochiKit.Async.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Async.toString=function(){return this.__repr__()};MochiKit.Async.Deferred=function(a){this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=a;this.silentlyCancelled=false;this.chained=false};MochiKit.Async.Deferred.prototype={repr:function(){var a;if(this.fired==-1){a="unfired"}else{if(this.fired===0){a="success"}else{a="error"}}return"Deferred("+this.id+", "+a+")"},toString:MochiKit.Base.forwardCall("repr"),_nextId:MochiKit.Base.counter(),cancel:function(){var a=MochiKit.Async;if(this.fired==-1){if(this.canceller){this.canceller(this)}else{this.silentlyCancelled=true}if(this.fired==-1){this.errback(new a.CancelledError(this))}}else{if((this.fired===0)&&(this.results[0] instanceof a.Deferred)){this.results[0].cancel()}}},_resback:function(a){this.fired=((a instanceof Error)?1:0);this.results[this.fired]=a;this._fire()},_check:function(){if(this.fired!=-1){if(!this.silentlyCancelled){throw new MochiKit.Async.AlreadyCalledError(this)}this.silentlyCancelled=false;return}},callback:function(a){this._check();if(a instanceof MochiKit.Async.Deferred){throw new Error("Deferred instances can only be chained if they are the result of a callback")}this._resback(a)},errback:function(b){this._check();var a=MochiKit.Async;if(b instanceof a.Deferred){throw new Error("Deferred instances can only be chained if they are the result of a callback")}if(!(b instanceof Error)){b=new a.GenericError(b)}this._resback(b)},addBoth:function(a){if(arguments.length>1){a=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(a,a)},addCallback:function(a){if(arguments.length>1){a=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(a,null)},addErrback:function(a){if(arguments.length>1){a=MochiKit.Base.partial.apply(null,arguments)}return this.addCallbacks(null,a)},addCallbacks:function(a,b){if(this.chained){throw new Error("Chained Deferreds can not be re-used")}this.chain.push([a,b]);if(this.fired>=0){this._fire()}return this},_fire:function(){var j=this.chain;var h=this.fired;var c=this.results[h];var b=this;var a=null;while(j.length>0&&this.paused===0){var g=j.shift();var e=g[h];if(e===null){continue}try{c=e(c);h=((c instanceof Error)?1:0);if(c instanceof MochiKit.Async.Deferred){a=function(f){b._resback(f);b.paused--;if((b.paused===0)&&(b.fired>=0)){b._fire()}};this.paused++}}catch(d){h=1;if(!(d instanceof Error)){d=new MochiKit.Async.GenericError(d)}c=d}}this.fired=h;this.results[h]=c;if(a&&this.paused){c.addBoth(a);c.chained=true}}};MochiKit.Base.update(MochiKit.Async,{evalJSONRequest:function(a){return MochiKit.Base.evalJSON(a.responseText)},succeed:function(a){var b=new MochiKit.Async.Deferred();b.callback.apply(b,arguments);return b},fail:function(a){var b=new MochiKit.Async.Deferred();b.errback.apply(b,arguments);return b},getXMLHttpRequest:function(){var a=arguments.callee;if(!a.XMLHttpRequest){var b=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},function(){throw new MochiKit.Async.BrowserComplianceError("Browser does not support XMLHttpRequest")}];for(var c=0;c<b.length;c++){var d=b[c];try{a.XMLHttpRequest=d;return d()}catch(f){}}}return a.XMLHttpRequest()},_xhr_onreadystatechange:function(g){var a=MochiKit.Base;if(this.readyState==4){try{this.onreadystatechange=null}catch(f){try{this.onreadystatechange=a.noop}catch(f){}}var b=null;try{b=this.status;if(!b&&a.isNotEmpty(this.responseText)){b=304}}catch(f){}if(b==200||b==201||b==204||b==304||b==1223){g.callback(this)}else{var c=new MochiKit.Async.XMLHttpRequestError(this,"Request failed");if(c.number){g.errback(c)}else{g.errback(c)}}}},_xhr_canceller:function(a){try{a.onreadystatechange=null}catch(b){try{a.onreadystatechange=MochiKit.Base.noop}catch(b){}}a.abort()},sendXMLHttpRequest:function(c,g){if(typeof(g)=="undefined"||g===null){g=""}var a=MochiKit.Base;var b=MochiKit.Async;var h=new b.Deferred(a.partial(b._xhr_canceller,c));try{c.onreadystatechange=a.bind(b._xhr_onreadystatechange,c,h);c.send(g)}catch(f){try{c.onreadystatechange=null}catch(j){}h.errback(f)}return h},doXHR:function(b,c){var a=MochiKit.Async;return a.callLater(0,a._doXHR,b,c)},_doXHR:function(c,a){var d=MochiKit.Base;a=d.update({method:"GET",sendContent:""},a);var l=MochiKit.Async;var h=l.getXMLHttpRequest();if(a.queryString){var g=d.queryString(a.queryString);if(g){c+="?"+g}}if("username" in a){h.open(a.method,c,true,a.username,a.password)}else{h.open(a.method,c,true)}if(h.overrideMimeType&&a.mimeType){h.overrideMimeType(a.mimeType)}h.setRequestHeader("X-Requested-With","XMLHttpRequest");if(a.headers){var k=a.headers;if(!d.isArrayLike(k)){k=d.items(k)}for(var e=0;e<k.length;e++){var j=k[e];var b=j[0];var f=j[1];h.setRequestHeader(b,f)}}return l.sendXMLHttpRequest(h,a.sendContent)},_buildURL:function(c){if(arguments.length>1){var b=MochiKit.Base;var a=b.queryString.apply(null,b.extend(null,arguments,1));if(a){return c+"?"+a}}return c},doSimpleXMLHttpRequest:function(b){var a=MochiKit.Async;b=a._buildURL.apply(a,arguments);return a.doXHR(b)},loadJSONDoc:function(b){var a=MochiKit.Async;b=a._buildURL.apply(a,arguments);var c=a.doXHR(b,{mimeType:"text/plain",headers:[["Accept","application/json"]]});c=c.addCallback(a.evalJSONRequest);return c},wait:function(e,c){var f=new MochiKit.Async.Deferred();var a=MochiKit.Base;if(typeof(c)!="undefined"){f.addCallback(function(){return c})}var b=setTimeout(a.bind("callback",f),Math.floor(e*1000));f.canceller=function(){try{clearTimeout(b)}catch(d){}};return f},callLater:function(b,c){var a=MochiKit.Base;var d=a.partial.apply(a,a.extend(null,arguments,1));return MochiKit.Async.wait(b).addCallback(function(e){return d()})}});MochiKit.Async.DeferredLock=function(){this.waiting=[];this.locked=false;this.id=this._nextId()};MochiKit.Async.DeferredLock.prototype={__class__:MochiKit.Async.DeferredLock,acquire:function(){var a=new MochiKit.Async.Deferred();if(this.locked){this.waiting.push(a)}else{this.locked=true;a.callback(this)}return a},release:function(){if(!this.locked){throw TypeError("Tried to release an unlocked DeferredLock")}this.locked=false;if(this.waiting.length>0){this.locked=true;this.waiting.shift().callback(this)}},_nextId:MochiKit.Base.counter(),repr:function(){var a;if(this.locked){a="locked, "+this.waiting.length+" waiting"}else{a="unlocked"}return"DeferredLock("+this.id+", "+a+")"},toString:MochiKit.Base.forwardCall("repr")};MochiKit.Async.DeferredList=function(j,g,f,c,b){MochiKit.Async.Deferred.apply(this,[b]);this.list=j;var a=[];this.resultList=a;this.finishedCount=0;this.fireOnOneCallback=g;this.fireOnOneErrback=f;this.consumeErrors=c;var e=MochiKit.Base.bind(this._cbDeferred,this);for(var h=0;h<j.length;h++){var k=j[h];a.push(undefined);k.addCallback(e,h,true);k.addErrback(e,h,false)}if(j.length===0&&!g){this.callback(this.resultList)}};MochiKit.Async.DeferredList.prototype=new MochiKit.Async.Deferred();MochiKit.Async.DeferredList.prototype._cbDeferred=function(c,b,a){this.resultList[c]=[b,a];this.finishedCount+=1;if(this.fired==-1){if(b&&this.fireOnOneCallback){this.callback([c,a])}else{if(!b&&this.fireOnOneErrback){this.errback(a)}else{if(this.finishedCount==this.list.length){this.callback(this.resultList)}}}}if(!b&&this.consumeErrors){a=null}return a};MochiKit.Async.gatherResults=function(a){var b=new MochiKit.Async.DeferredList(a,false,true,false);b.addCallback(function(e){var c=[];for(var d=0;d<e.length;d++){c.push(e[d][1])}return c});return b};MochiKit.Async.maybeDeferred=function(c){var a=MochiKit.Async;var f;try{var b=c.apply(null,MochiKit.Base.extend([],arguments,1));if(b instanceof a.Deferred){f=b}else{if(b instanceof Error){f=a.fail(b)}else{f=a.succeed(b)}}}catch(d){f=a.fail(d)}return f};MochiKit.Async.EXPORT=["AlreadyCalledError","CancelledError","BrowserComplianceError","GenericError","XMLHttpRequestError","Deferred","succeed","fail","getXMLHttpRequest","doSimpleXMLHttpRequest","loadJSONDoc","wait","callLater","sendXMLHttpRequest","DeferredLock","DeferredList","gatherResults","maybeDeferred","doXHR"];MochiKit.Async.EXPORT_OK=["evalJSONRequest"];MochiKit.Async.__new__=function(){var a=MochiKit.Base;var b=a.partial(a._newNamedError,this);b("AlreadyCalledError",function(c){this.deferred=c});b("CancelledError",function(c){this.deferred=c});b("BrowserComplianceError",function(c){this.message=c});b("GenericError",function(c){this.message=c});b("XMLHttpRequestError",function(c,f){this.req=c;this.message=f;try{this.number=c.status}catch(d){}});this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};MochiKit.Async.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Async);MochiKit.Base._deps("DOM",["Base"]);MochiKit.DOM.NAME="MochiKit.DOM";MochiKit.DOM.VERSION="1.4";MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.DOM.toString=function(){return this.__repr__()};MochiKit.DOM.EXPORT=["removeEmptyTextNodes","formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","createINPUT","createINPUTFunc","isChildNode","getNodeAttribute","removeNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","insertSiblingNodesAfter","insertSiblingNodesBefore","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","H4","H5","H6","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","DL","DT","DD","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","IMG","BUTTON","FORMBUTTON","CHECKBOX","FILE","HIDDEN","IMAGE","PASSWORD","RADIO","RESET","TEXT","SUBMIT","getElement","$","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","escapeHTML","toHTML","emitHTML","scrapeText","isParent","getFirstParentByTagAndClassName","makeClipping","undoClipping","makePositioned","undoPositioned","getFirstElementByTagAndClassName"];MochiKit.DOM.EXPORT_OK=["domConverters"];MochiKit.DOM.DEPRECATED=[["computedStyle","MochiKit.Style.getStyle","1.4"],["elementDimensions","MochiKit.Style.getElementDimensions","1.4"],["elementPosition","MochiKit.Style.getElementPosition","1.4"],["hideElement","MochiKit.Style.hideElement","1.4"],["setElementDimensions","MochiKit.Style.setElementDimensions","1.4"],["setElementPosition","MochiKit.Style.setElementPosition","1.4"],["setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4"],["setOpacity","MochiKit.Style.setOpacity","1.4"],["showElement","MochiKit.Style.showElement","1.4"],["Coordinates","MochiKit.Style.Coordinates","1.4"],["Dimensions","MochiKit.Style.Dimensions","1.4"]];MochiKit.DOM.getViewportDimensions=new Function('if (!MochiKit["Style"]) {    throw new Error("This function has been deprecated and depends on MochiKit.Style.");}return MochiKit.Style.getViewportDimensions.apply(this, arguments);');MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(h,d){var a=MochiKit.DOM;var c=a._document;var b=a._window;var g;try{a._window=h;a._document=h.document;g=d()}catch(f){a._window=b;a._document=c;throw f}a._window=b;a._document=c;return g},formContents:function(d){var b=[];var e=[];var a=MochiKit.Base;var c=MochiKit.DOM;if(typeof(d)=="undefined"||d===null){d=c._document.body}else{d=c.getElement(d)}a.nodeWalk(d,function(n){var g=n.name;if(a.isNotEmpty(g)){var o=n.tagName.toUpperCase();if(o==="INPUT"&&(n.type=="radio"||n.type=="checkbox")&&!n.checked){return null}if(o==="SELECT"){if(n.type=="select-one"){if(n.selectedIndex>=0){var k=n.options[n.selectedIndex];var f=k.value;if(!f){var l=k.outerHTML;if(l&&!l.match(/^[^>]+\svalue\s*=/i)){f=k.text}}b.push(g);e.push(f);return null}b.push(g);e.push("");return null}else{var m=n.options;if(!m.length){b.push(g);e.push("");return null}for(var j=0;j<m.length;j++){var k=m[j];if(!k.selected){continue}var f=k.value;if(!f){var l=k.outerHTML;if(l&&!l.match(/^[^>]+\svalue\s*=/i)){f=k.text}}b.push(g);e.push(f)}return null}}if(o==="FORM"||o==="P"||o==="SPAN"||o==="DIV"){return n.childNodes}b.push(g);e.push(n.value||"");return null}return n.childNodes});return[b,e]},withDocument:function(g,c){var a=MochiKit.DOM;var b=a._document;var f;try{a._document=g;f=c()}catch(d){a._document=b;throw d}a._document=b;return f},registerDOMConverter:function(a,d,b,c){MochiKit.DOM.domConverters.register(a,d,b,c)},coerceToDOM:function(f,q){var g=MochiKit.Base;var l=MochiKit.Iter;var o=MochiKit.DOM;if(l){var n=l.iter;var b=l.repeat;var a=g.map}var j=o.domConverters;var h=arguments.callee;var d=g.NotFound;while(true){if(typeof(f)=="undefined"||f===null){return null}if(typeof(f)=="function"&&typeof(f.length)=="number"&&!(f instanceof Function)){f=l.list(f)}if(typeof(f.nodeType)!="undefined"&&f.nodeType>0){return f}if(typeof(f)=="number"||typeof(f)=="boolean"){f=f.toString()}if(typeof(f)=="string"){return o._document.createTextNode(f)}if(typeof(f.__dom__)=="function"){f=f.__dom__(q);continue}if(typeof(f.dom)=="function"){f=f.dom(q);continue}if(typeof(f)=="function"){f=f.apply(q,[q]);continue}if(l){var c=null;try{c=n(f)}catch(k){}if(c){return a(h,c,b(q))}}try{f=j.match(f,q);continue}catch(k){if(k!=d){throw k}}return o._document.createTextNode(f.toString())}return undefined},isChildNode:function(c,a){var b=MochiKit.DOM;if(typeof(c)=="string"){c=b.getElement(c)}if(typeof(a)=="string"){a=b.getElement(a)}if(typeof(c)=="undefined"||c===null){return false}while(c!==b._document){if(c===a){return true}c=c.parentNode}return false},setNodeAttribute:function(b,a,c){var f={};f[a]=c;try{return MochiKit.DOM.updateNodeAttributes(b,f)}catch(d){}return null},getNodeAttribute:function(d,a){var c=MochiKit.DOM;var b=c.attributeArray.renames[a];d=c.getElement(d);try{if(b){return d[b]}return d.getAttribute(a)}catch(f){}return null},removeNodeAttribute:function(d,a){var b=MochiKit.DOM;var c=b.attributeArray.renames[a];d=b.getElement(d);try{if(c){return d[c]}return d.removeAttribute(a)}catch(f){}return null},updateNodeAttributes:function(a,g){var b=a;var j=MochiKit.DOM;if(typeof(a)=="string"){b=j.getElement(a)}if(g){var f=MochiKit.Base.updatetree;if(j.attributeArray.compliant){for(var c in g){var h=g[c];if(typeof(h)=="object"&&typeof(b[c])=="object"){if(c=="style"&&MochiKit.Style){MochiKit.Style.setStyle(b,h)}else{f(b[c],h)}}else{if(c.substring(0,2)=="on"){if(typeof(h)=="string"){h=new Function(h)}b[c]=h}else{b.setAttribute(c,h)}}}}else{var e=j.attributeArray.renames;for(var c in g){h=g[c];var d=e[c];if(c=="style"&&typeof(h)=="string"){b.style.cssText=h}else{if(typeof(d)=="string"){b[d]=h}else{if(typeof(b[c])=="object"&&typeof(h)=="object"){if(c=="style"&&MochiKit.Style){MochiKit.Style.setStyle(b,h)}else{f(b[c],h)}}else{if(c.substring(0,2)=="on"){if(typeof(h)=="string"){h=new Function(h)}b[c]=h}else{b.setAttribute(c,h)}}}}}}}return b},appendChildNodes:function(c){var b=c;var a=MochiKit.DOM;if(typeof(c)=="string"){b=a.getElement(c)}var e=[a.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)];var d=MochiKit.Base.concat;while(e.length){var f=e.shift();if(typeof(f)=="undefined"||f===null){}else{if(typeof(f.nodeType)=="number"){b.appendChild(f)}else{e=d(f,e)}}}return b},insertSiblingNodesBefore:function(f){var e=f;var b=MochiKit.DOM;if(typeof(f)=="string"){e=b.getElement(f)}var d=[b.coerceToDOM(MochiKit.Base.extend(null,arguments,1),e)];var c=e.parentNode;var a=MochiKit.Base.concat;while(d.length){var g=d.shift();if(typeof(g)=="undefined"||g===null){}else{if(typeof(g.nodeType)=="number"){c.insertBefore(g,e)}else{d=a(g,d)}}}return c},insertSiblingNodesAfter:function(c){var b=c;var a=MochiKit.DOM;if(typeof(c)=="string"){b=a.getElement(c)}var d=[a.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)];if(b.nextSibling){return a.insertSiblingNodesBefore(b.nextSibling,d)}else{return a.appendChildNodes(b.parentNode,d)}},replaceChildNodes:function(c){var b=c;var a=MochiKit.DOM;if(typeof(c)=="string"){b=a.getElement(c);arguments[0]=b}var d;while((d=b.firstChild)){b.removeChild(d)}if(arguments.length<2){return b}else{return a.appendChildNodes.apply(this,arguments)}},createDOM:function(b,c){var e;var j=MochiKit.DOM;var f=MochiKit.Base;if(typeof(c)=="string"||typeof(c)=="number"){var h=f.extend([b,null],arguments,1);return arguments.callee.apply(this,h)}if(typeof(b)=="string"){var a=j._xhtml;if(c&&!j.attributeArray.compliant){var k="";if("name" in c){k+=' name="'+j.escapeHTML(c.name)+'"'}if(b=="input"&&"type" in c){k+=' type="'+j.escapeHTML(c.type)+'"'}if(k){b="<"+b+k+">";a=false}}var g=j._document;if(a&&g===document){e=g.createElementNS("http://www.w3.org/1999/xhtml",b)}else{e=g.createElement(b)}}else{e=b}if(c){j.updateNodeAttributes(e,c)}if(arguments.length<=2){return e}else{var h=f.extend([e],arguments,2);return j.appendChildNodes.apply(this,h)}},createDOMFunc:function(){var a=MochiKit.Base;return a.partial.apply(this,a.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(a){var b=MochiKit.DOM.getElement(a);b.parentNode.removeChild(b);return b},swapDOM:function(c,d){var b=MochiKit.DOM;c=b.getElement(c);var a=c.parentNode;if(d){d=b.getElement(d);a.replaceChild(d,c)}else{a.removeChild(c)}return d},createINPUT:function(c,b){var a=MochiKit.Base;if(typeof(b)=="string"||typeof(b)=="number"){return MochiKit.DOM.createDOM("input",{name:b,type:c})}return MochiKit.DOM.createDOM("input",a.update(b,{type:c}))},createINPUTFunc:function(){var a=MochiKit.Base;return a.partial.apply(this,a.extend([MochiKit.DOM.createINPUT],arguments))},getElement:function(b){var a=MochiKit.DOM;if(arguments.length==1){return((typeof(b)=="string")?a._document.getElementById(b):b)}else{return MochiKit.Base.map(a.getElement,arguments)}},getElementsByTagAndClassName:function(k,h,g){var m=MochiKit.DOM;if(typeof(k)=="undefined"||k===null){k="*"}if(typeof(g)=="undefined"||g===null){g=m._document}g=m.getElement(g);var f=(g.getElementsByTagName(k)||m._document.all);if(typeof(h)=="undefined"||h===null){return MochiKit.Base.extend(null,f)}var e=[];for(var b=0;b<f.length;b++){var d=f[b];var l=d.className;if(!l){continue}var c=l.split(" ");for(var a=0;a<c.length;a++){if(c[a]==h){e.push(d);break}}}return e},_newCallStack:function(c,a){var b=function(){var d=arguments.callee.callStack;for(var f=0;f<d.length;f++){if(d[f].apply(this,arguments)===false){break}}if(a){try{this[c]=null}catch(g){}}};b.callStack=[];return b},addToCallStack:function(g,f,d,b){var a=MochiKit.DOM;var e=g[f];var c=e;if(!(typeof(e)=="function"&&typeof(e.callStack)=="object"&&e.callStack!==null)){c=a._newCallStack(f,b);if(typeof(e)=="function"){c.callStack.push(e)}g[f]=c}c.callStack.push(d)},addLoadEvent:function(b){var a=MochiKit.DOM;a.addToCallStack(a._window,"onload",b,true)},focusOnLoad:function(b){var a=MochiKit.DOM;a.addLoadEvent(function(){b=a.getElement(b);if(b){b.focus()}})},setElementClass:function(a,c){var b=MochiKit.DOM;var d=b.getElement(a);if(b.attributeArray.compliant){d.setAttribute("class",c)}else{d.setAttribute("className",c)}},toggleElementClass:function(b){var a=MochiKit.DOM;for(var c=1;c<arguments.length;c++){var d=a.getElement(arguments[c]);if(!a.addElementClass(d,b)){a.removeElementClass(d,b)}}},addElementClass:function(a,g){var c=MochiKit.DOM;var f=c.getElement(a);var b=f.className;if(b==undefined||b.length===0){c.setElementClass(f,g);return true}if(b==g){return false}var e=b.split(" ");for(var d=0;d<e.length;d++){if(e[d]==g){return false}}c.setElementClass(f,b+" "+g);return true},removeElementClass:function(f,c){var b=MochiKit.DOM;var g=b.getElement(f);var a=g.className;if(a==undefined||a.length===0){return false}if(a==c){b.setElementClass(g,"");return true}var e=a.split(" ");for(var d=0;d<e.length;d++){if(e[d]==c){e.splice(d,1);b.setElementClass(g,e.join(" "));return true}}return false},swapElementClass:function(b,c,a){var e=MochiKit.DOM.getElement(b);var d=MochiKit.DOM.removeElementClass(e,c);if(d){MochiKit.DOM.addElementClass(e,a)}return d},hasElementClass:function(h,g){var f=MochiKit.DOM.getElement(h);var a=f.className;if(!a){return false}var e=a.split(" ");for(var c=1;c<arguments.length;c++){var d=false;for(var b=0;b<e.length;b++){if(e[b]==arguments[c]){d=true;break}}if(!d){return false}}return true},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(a){return MochiKit.DOM.emitHTML(a).join("")},emitHTML:function(k,n){if(typeof(n)=="undefined"||n===null){n=[]}var l=[k];var q=MochiKit.DOM;var g=q.escapeHTML;var f=q.attributeArray;while(l.length){k=l.pop();if(typeof(k)=="string"){n.push(k)}else{if(k.nodeType==1){n.push("<"+k.tagName.toLowerCase());var d=[];var c=f(k);for(var m=0;m<c.length;m++){var o=c[m];d.push([" ",o.name,'="',g(o.value),'"'])}d.sort();for(m=0;m<d.length;m++){var b=d[m];for(var h=0;h<b.length;h++){n.push(b[h])}}if(k.hasChildNodes()){n.push(">");l.push("</"+k.tagName.toLowerCase()+">");var e=k.childNodes;for(m=e.length-1;m>=0;m--){l.push(e[m])}}else{n.push("/>")}}else{if(k.nodeType==3){n.push(g(k.nodeValue))}}}}return n},scrapeText:function(a,c){var b=[];(function(e){var g=e.childNodes;if(g){for(var d=0;d<g.length;d++){arguments.callee.call(this,g[d])}}var f=e.nodeValue;if(typeof(f)=="string"){b.push(f)}})(MochiKit.DOM.getElement(a));if(c){return b}else{return b.join("")}},removeEmptyTextNodes:function(c){c=MochiKit.DOM.getElement(c);for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes[a];if(b.nodeType==3&&!/\S/.test(b.nodeValue)){b.parentNode.removeChild(b)}}},makeClipping:function(b){b=MochiKit.DOM.getElement(b);var a=b.style.overflow;if((MochiKit.Style.getStyle(b,"overflow")||"visible")!="hidden"){b.style.overflow="hidden"}return a},undoClipping:function(b,a){b=MochiKit.DOM.getElement(b);if(!a){return}b.style.overflow=a},makePositioned:function(b){b=MochiKit.DOM.getElement(b);var a=MochiKit.Style.getStyle(b,"position");if(a=="static"||!a){b.style.position="relative";if(/Opera/.test(navigator.userAgent)){b.style.top=0;b.style.left=0}}},undoPositioned:function(a){a=MochiKit.DOM.getElement(a);if(a.style.position=="relative"){a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}},getFirstElementByTagAndClassName:function(e,d,c){var h=MochiKit.DOM;if(typeof(e)=="undefined"||e===null){e="*"}if(typeof(c)=="undefined"||c===null){c=h._document}c=h.getElement(c);var b=(c.getElementsByTagName(e)||h._document.all);if(typeof(d)=="undefined"||d===null){return b[0]}for(var g=0;g<b.length;g++){var a=b[g];var k=a.className.split(" ");for(var f=0;f<k.length;f++){if(k[f]==d){return a}}}},getFirstParentByTagAndClassName:function(e,d,c){var b=MochiKit.DOM;e=b.getElement(e);if(typeof(d)=="undefined"||d===null){d="*"}else{d=d.toUpperCase()}if(typeof(c)=="undefined"||c===null){c=null}if(e){e=e.parentNode}while(e&&e.tagName&&typeof(e.className)=="string"){var a=e.tagName.toUpperCase();if((d==="*"||d==a)&&(c===null||b.hasElementClass(e,c))){return e}e=e.parentNode}return null},isParent:function(b,a){if(!b.parentNode||b==a){return false}if(b.parentNode==a){return true}return MochiKit.DOM.isParent(b.parentNode,a)},__new__:function(f){var b=MochiKit.Base;if(typeof(document)!="undefined"){this._document=document;var q="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";this._xhtml=(document.documentElement&&document.createElementNS&&document.documentElement.namespaceURI===q)}else{if(MochiKit.MockDOM){this._document=MochiKit.MockDOM.document}}this._window=f;this.domConverters=new b.AdapterRegistry();var o=this._document.createElement("span");var n;if(o&&o.attributes&&o.attributes.length>0){var k=b.filter;n=function(a){return k(n.ignoreAttrFilter,a.attributes)};n.ignoreAttr={};var j=o.attributes;var g=n.ignoreAttr;for(var e=0;e<j.length;e++){var l=j[e];g[l.name]=l.value}n.ignoreAttrFilter=function(m){return(n.ignoreAttr[m.name]!=m.value)};n.compliant=false;n.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor",readonly:"readOnly",colspan:"colSpan",bgcolor:"bgColor",cellspacing:"cellSpacing",cellpadding:"cellPadding"}}else{n=function(a){return a.attributes};n.compliant=true;n.renames={}}this.attributeArray=n;var c=function(r,a){var m=a[1].split(".");var t="";var s={};t+="if (!MochiKit."+m[1]+') { throw new Error("';t+="This function has been deprecated and depends on MochiKit.";t+=m[1]+'.");}';t+="return MochiKit."+m[1]+"."+a[0];t+=".apply(this, arguments);";s[m[2]]=new Function(t);MochiKit.Base.update(MochiKit[r],s)};for(var e;e<MochiKit.DOM.DEPRECATED.length;e++){c("DOM",MochiKit.DOM.DEPRECATED[e])}var d=this.createDOMFunc;this.UL=d("ul");this.OL=d("ol");this.LI=d("li");this.DL=d("dl");this.DT=d("dt");this.DD=d("dd");this.TD=d("td");this.TR=d("tr");this.TBODY=d("tbody");this.THEAD=d("thead");this.TFOOT=d("tfoot");this.TABLE=d("table");this.TH=d("th");this.INPUT=d("input");this.SPAN=d("span");this.A=d("a");this.DIV=d("div");this.IMG=d("img");this.BUTTON=d("button");this.TT=d("tt");this.PRE=d("pre");this.H1=d("h1");this.H2=d("h2");this.H3=d("h3");this.H4=d("h4");this.H5=d("h5");this.H6=d("h6");this.BR=d("br");this.HR=d("hr");this.LABEL=d("label");this.TEXTAREA=d("textarea");this.FORM=d("form");this.P=d("p");this.SELECT=d("select");this.OPTION=d("option");this.OPTGROUP=d("optgroup");this.LEGEND=d("legend");this.FIELDSET=d("fieldset");this.STRONG=d("strong");this.CANVAS=d("canvas");var h=this.createINPUTFunc;this.FORMBUTTON=h("button");this.CHECKBOX=h("checkbox");this.FILE=h("file");this.HIDDEN=h("hidden");this.IMAGE=h("image");this.PASSWORD=h("password");this.RADIO=h("radio");this.RESET=h("reset");this.TEXT=h("text");this.SUBMIT=h("submit");this.$=this.getElement;this.EXPORT_TAGS={":common":this.EXPORT,":all":b.concat(this.EXPORT,this.EXPORT_OK)};b.nameFunctions(this)}});MochiKit.DOM.__new__(((typeof(window)=="undefined")?this:window));if(MochiKit.__export__){withWindow=MochiKit.DOM.withWindow;withDocument=MochiKit.DOM.withDocument}MochiKit.Base._exportSymbols(this,MochiKit.DOM);MochiKit.Base._deps("Selector",["Base","DOM","Iter"]);MochiKit.Selector.NAME="MochiKit.Selector";MochiKit.Selector.VERSION="1.4";MochiKit.Selector.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Selector.toString=function(){return this.__repr__()};MochiKit.Selector.EXPORT=["Selector","findChildElements","findDocElements","$$"];MochiKit.Selector.EXPORT_OK=[];MochiKit.Selector.Selector=function(a){this.params={classNames:[],pseudoClassNames:[]};this.expression=a.toString().replace(/(^\s+|\s+$)/g,"");this.parseExpression();this.compileMatcher()};MochiKit.Selector.Selector.prototype={__class__:MochiKit.Selector.Selector,parseExpression:function(){function h(j){throw"Parse error in selector: "+j}if(this.expression==""){h("empty expression")}var b=MochiKit.Base.repr;var a=this.params;var f=this.expression;var g,e,d,c;while(g=f.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!^$*]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i)){a.attributes=a.attributes||[];a.attributes.push({name:g[2],operator:g[3],value:g[4]||g[5]||""});f=g[1]}if(f=="*"){return this.params.wildcard=true}while(g=f.match(/^([^a-z0-9_-])?([a-z0-9_-]+(?:\([^)]*\))?)(.*)/i)){e=g[1];d=g[2];c=g[3];switch(e){case"#":a.id=d;break;case".":a.classNames.push(d);break;case":":a.pseudoClassNames.push(d);break;case"":case undefined:a.tagName=d.toUpperCase();break;default:h(b(f))}f=c}if(f.length>0){h(b(f))}},buildMatchExpression:function(){var j=MochiKit.Base.repr;var h=this.params;var g=[];var f,k;function n(a){return"MochiKit.Base.filter(function (node) { return node.nodeType == 1; }, "+a+".childNodes)"}if(h.wildcard){g.push("true")}if(f=h.id){g.push("element.id == "+j(f))}if(f=h.tagName){g.push("element.tagName.toUpperCase() == "+j(f))}if((f=h.classNames).length>0){for(k=0;k<f.length;k++){g.push("MochiKit.DOM.hasElementClass(element, "+j(f[k])+")")}}if((f=h.pseudoClassNames).length>0){for(k=0;k<f.length;k++){var e=f[k].match(/^([^(]+)(?:\((.*)\))?$/);var d=e[1];var c=e[2];switch(d){case"root":g.push("element.nodeType == 9 || element === element.ownerDocument.documentElement");break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":e=c.match(/^((?:(\d+)n\+)?(\d+)|odd|even)$/);if(!e){throw"Invalid argument to pseudo element nth-child: "+c}var m,l;if(e[0]=="odd"){m=2;l=1}else{if(e[0]=="even"){m=2;l=0}else{m=e[2]&&parseInt(e)||null;l=parseInt(e[3])}}g.push("this.nthChild(element,"+m+","+l+","+!!d.match("^nth-last")+","+!!d.match("of-type$")+")");break;case"first-child":g.push("this.nthChild(element, null, 1)");break;case"last-child":g.push("this.nthChild(element, null, 1, true)");break;case"first-of-type":g.push("this.nthChild(element, null, 1, false, true)");break;case"last-of-type":g.push("this.nthChild(element, null, 1, true, true)");break;case"only-child":g.push(n("element.parentNode")+".length == 1");break;case"only-of-type":g.push("MochiKit.Base.filter(function (node) { return node.tagName == element.tagName; }, "+n("element.parentNode")+").length == 1");break;case"empty":g.push("element.childNodes.length == 0");break;case"enabled":g.push("(this.isUIElement(element) && element.disabled === false)");break;case"disabled":g.push("(this.isUIElement(element) && element.disabled === true)");break;case"checked":g.push("(this.isUIElement(element) && element.checked === true)");break;case"not":var o=new MochiKit.Selector.Selector(c);g.push("!( "+o.buildMatchExpression()+")");break}}}if(f=h.attributes){MochiKit.Base.map(function(a){var q="MochiKit.DOM.getNodeAttribute(element, "+j(a.name)+")";var b=function(r){return q+".split("+j(r)+")"};switch(a.operator){case"=":g.push(q+" == "+j(a.value));break;case"~=":g.push(q+" && MochiKit.Base.findValue("+b(" ")+", "+j(a.value)+") > -1");break;case"^=":g.push(q+".substring(0, "+a.value.length+") == "+j(a.value));break;case"$=":g.push(q+".substring("+q+".length - "+a.value.length+") == "+j(a.value));break;case"*=":g.push(q+".match("+j(a.value)+")");break;case"|=":g.push(q+" && "+b("-")+"[0].toUpperCase() == "+j(a.value.toUpperCase()));break;case"!=":g.push(q+" != "+j(a.value));break;case"":case undefined:g.push(q+" != null");break;default:throw"Unknown operator "+a.operator+" in selector"}},f)}return g.join(" && ")},compileMatcher:function(){this.match=new Function("element","if (!element.tagName) return false;                 return "+this.buildMatchExpression())},nthChild:function(g,d,c,j,h){var f=MochiKit.Base.filter(function(a){return a.nodeType==1},g.parentNode.childNodes);if(h){f=MochiKit.Base.filter(function(a){return a.tagName==g.tagName},f)}if(j){f=MochiKit.Iter.reversed(f)}if(d){var e=MochiKit.Base.findIdentical(f,g);return((e+1-c)/d)%1==0}else{return c==MochiKit.Base.findIdentical(f,g)+1}},isUIElement:function(a){return MochiKit.Base.findValue(["input","button","select","option","textarea","object"],a.tagName.toLowerCase())>-1},findElements:function(f,g){var d;if(g==undefined){g=""}function c(j,h){if(g==""){return MochiKit.DOM.isChildNode(j,h)}else{if(g==">"){return j.parentNode==h}else{if(g=="+"){return j==e(h)}else{if(g=="~"){var k=h;while(k=e(k)){if(j==k){return true}}return false}else{throw"Invalid axis: "+g}}}}}if(d=MochiKit.DOM.getElement(this.params.id)){if(this.match(d)){if(!f||c(d,f)){return[d]}}}function e(h){h=h.nextSibling;while(h&&h.nodeType!=1){h=h.nextSibling}return h}if(g==""){f=(f||MochiKit.DOM.currentDocument()).getElementsByTagName(this.params.tagName||"*")}else{if(g==">"){if(!f){throw"> combinator not allowed without preceeding expression"}f=MochiKit.Base.filter(function(h){return h.nodeType==1},f.childNodes)}else{if(g=="+"){if(!f){throw"+ combinator not allowed without preceeding expression"}f=e(f)&&[e(f)]}else{if(g=="~"){if(!f){throw"~ combinator not allowed without preceeding expression"}var b=[];while(e(f)){f=e(f);b.push(f)}f=b}}}}if(!f){return[]}var a=MochiKit.Base.filter(MochiKit.Base.bind(function(h){return this.match(h)},this),f);return a},repr:function(){return"Selector("+this.expression+")"},toString:MochiKit.Base.forwardCall("repr")};MochiKit.Base.update(MochiKit.Selector,{findChildElements:function(b,a){return MochiKit.Base.flattenArray(MochiKit.Base.map(function(d){var c="";return MochiKit.Iter.reduce(function(g,h){if(match=h.match(/^[>+~]$/)){c=match[0];return g}else{var f=new MochiKit.Selector.Selector(h);var e=MochiKit.Iter.reduce(function(k,j){return MochiKit.Base.extend(k,f.findElements(j||b,c))},g,[]);c="";return e}},d.replace(/(^\s+|\s+$)/g,"").split(/\s+/),[null])},a))},findDocElements:function(){return MochiKit.Selector.findChildElements(MochiKit.DOM.currentDocument(),arguments)},__new__:function(){var a=MochiKit.Base;this.$$=this.findDocElements;this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)}});MochiKit.Selector.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Selector);MochiKit.Base._deps("Style",["Base","DOM"]);MochiKit.Style.NAME="MochiKit.Style";MochiKit.Style.VERSION="1.4";MochiKit.Style.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Style.toString=function(){return this.__repr__()};MochiKit.Style.EXPORT_OK=[];MochiKit.Style.EXPORT=["setStyle","setOpacity","getStyle","getElementDimensions","elementDimensions","setElementDimensions","getElementPosition","elementPosition","setElementPosition","setDisplayForElement","hideElement","showElement","getViewportDimensions","getViewportPosition","Dimensions","Coordinates"];MochiKit.Style.Dimensions=function(a,b){this.w=a;this.h=b};MochiKit.Style.Dimensions.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{w: "+a(this.w)+", h: "+a(this.h)+"}"};MochiKit.Style.Dimensions.prototype.toString=function(){return this.__repr__()};MochiKit.Style.Coordinates=function(a,b){this.x=a;this.y=b};MochiKit.Style.Coordinates.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{x: "+a(this.x)+", y: "+a(this.y)+"}"};MochiKit.Style.Coordinates.prototype.toString=function(){return this.__repr__()};MochiKit.Base.update(MochiKit.Style,{getStyle:function(e,f){var h=MochiKit.DOM;var g=h._document;e=h.getElement(e);f=MochiKit.Base.camelize(f);if(!e||e==g){return undefined}if(f=="opacity"&&e.filters){var c=(MochiKit.Style.getStyle(e,"filter")||"").match(/alpha\(opacity=(.*)\)/);if(c&&c[1]){return parseFloat(c[1])/100}return 1}var a=e.style?e.style[f]:null;if(!a){if(g.defaultView&&g.defaultView.getComputedStyle){var b=g.defaultView.getComputedStyle(e,null);f=f.replace(/([A-Z])/g,"-$1").toLowerCase();a=b?b.getPropertyValue(f):null}else{if(e.currentStyle){a=e.currentStyle[f]}}}if(f=="opacity"){a=parseFloat(a)}if(/Opera/.test(navigator.userAgent)&&(MochiKit.Base.find(["left","top","right","bottom"],f)!=-1)){if(MochiKit.Style.getStyle(e,"position")=="static"){a="auto"}}return a=="auto"?null:a},setStyle:function(c,a){c=MochiKit.DOM.getElement(c);for(var b in a){if(b=="opacity"){MochiKit.Style.setOpacity(c,a[b])}else{c.style[MochiKit.Base.camelize(b)]=a[b]}}},setOpacity:function(c,d){c=MochiKit.DOM.getElement(c);var b=MochiKit.Style;if(d==1){var a=/Gecko/.test(navigator.userAgent)&&!(/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent));c.style.opacity=a?0.999999:1;if(/MSIE/.test(navigator.userAgent)){c.style.filter=b.getStyle(c,"filter").replace(/alpha\([^\)]*\)/gi,"")}}else{if(d<0.00001){d=0}c.style.opacity=d;if(/MSIE/.test(navigator.userAgent)){c.style.filter=b.getStyle(c,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+d*100+")"}}},getElementPosition:function(f,e){var r=MochiKit.Style;var g=MochiKit.DOM;f=g.getElement(f);if(!f||(!(f.x&&f.y)&&(!f.parentNode===null||r.getStyle(f,"display")=="none"))){return undefined}var l=new r.Coordinates(0,0);var h=null;var q=null;var j=MochiKit.DOM._document;var n=j.documentElement;var m=j.body;if(!f.parentNode&&f.x&&f.y){l.x+=f.x||0;l.y+=f.y||0}else{if(f.getBoundingClientRect){h=f.getBoundingClientRect();l.x+=h.left+(n.scrollLeft||m.scrollLeft)-(n.clientLeft||0);l.y+=h.top+(n.scrollTop||m.scrollTop)-(n.clientTop||0)}else{if(f.offsetParent){l.x+=f.offsetLeft;l.y+=f.offsetTop;q=f.offsetParent;if(q!=f){while(q){l.x+=q.offsetLeft;l.y+=q.offsetTop;q=q.offsetParent}}var a=navigator.userAgent.toLowerCase();if((typeof(opera)!="undefined"&&parseFloat(opera.version())<9)||(a.indexOf("AppleWebKit")!=-1&&r.getStyle(f,"position")=="absolute")){l.x-=m.offsetLeft;l.y-=m.offsetTop}if(f.parentNode){q=f.parentNode}else{q=null}while(q){var k=q.tagName.toUpperCase();if(k==="BODY"||k==="HTML"){break}var o=r.getStyle(q,"display");if(o.search(/^inline|table-row.*$/i)){l.x-=q.scrollLeft;l.y-=q.scrollTop}if(q.parentNode){q=q.parentNode}else{q=null}}}}}if(typeof(e)!="undefined"){e=arguments.callee(e);if(e){l.x-=(e.x||0);l.y-=(e.y||0)}}return l},setElementPosition:function(e,d,c){e=MochiKit.DOM.getElement(e);if(typeof(c)=="undefined"){c="px"}var b={};var a=MochiKit.Base.isUndefinedOrNull;if(!a(d.x)){b.left=d.x+c}if(!a(d.y)){b.top=d.y+c}MochiKit.DOM.updateNodeAttributes(e,{style:b})},getElementDimensions:function(a){var j=MochiKit.Style;var d=MochiKit.DOM;if(typeof(a.w)=="number"||typeof(a.h)=="number"){return new j.Dimensions(a.w||0,a.h||0)}a=d.getElement(a);if(!a){return undefined}var h=j.getStyle(a,"display");if(h!="none"&&h!==""&&typeof(h)!="undefined"){return new j.Dimensions(a.offsetWidth||0,a.offsetHeight||0)}var k=a.style;var g=k.visibility;var f=k.position;var e=k.display;k.visibility="hidden";k.position="absolute";k.display="";var c=a.offsetWidth;var b=a.offsetHeight;k.display=e;k.position=f;k.visibility=g;return new j.Dimensions(c,b)},setElementDimensions:function(e,d,c){e=MochiKit.DOM.getElement(e);if(typeof(c)=="undefined"){c="px"}var b={};var a=MochiKit.Base.isUndefinedOrNull;if(!a(d.w)){b.width=d.w+c}if(!a(d.h)){b.height=d.h+c}MochiKit.DOM.updateNodeAttributes(e,{style:b})},setDisplayForElement:function(d,b){var c=MochiKit.Base.extend(null,arguments,1);var a=MochiKit.DOM.getElement;for(var e=0;e<c.length;e++){b=a(c[e]);if(b){b.style.display=d}}},getViewportDimensions:function(){var e=new MochiKit.Style.Dimensions();var c=MochiKit.DOM._window;var a=MochiKit.DOM._document.body;if(c.innerWidth){e.w=c.innerWidth;e.h=c.innerHeight}else{if(a.parentElement.clientWidth){e.w=a.parentElement.clientWidth;e.h=a.parentElement.clientHeight}else{if(a&&a.clientWidth){e.w=a.clientWidth;e.h=a.clientHeight}}}return e},getViewportPosition:function(){var f=new MochiKit.Style.Coordinates(0,0);var b=MochiKit.DOM._document;var e=b.documentElement;var a=b.body;if(e&&(e.scrollTop||e.scrollLeft)){f.x=e.scrollLeft;f.y=e.scrollTop}else{if(a){f.x=a.scrollLeft;f.y=a.scrollTop}}return f},__new__:function(){var a=MochiKit.Base;this.elementPosition=this.getElementPosition;this.elementDimensions=this.getElementDimensions;this.hideElement=a.partial(this.setDisplayForElement,"none");this.showElement=a.partial(this.setDisplayForElement,"block");this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)}});MochiKit.Style.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Style);MochiKit.Base._deps("LoggingPane",["Base","Logging"]);MochiKit.LoggingPane.NAME="MochiKit.LoggingPane";MochiKit.LoggingPane.VERSION="1.4";MochiKit.LoggingPane.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.LoggingPane.toString=function(){return this.__repr__()};MochiKit.LoggingPane.createLoggingPane=function(b){var a=MochiKit.LoggingPane;b=!(!b);if(a._loggingPane&&a._loggingPane.inline!=b){a._loggingPane.closePane();a._loggingPane=null}if(!a._loggingPane||a._loggingPane.closed){a._loggingPane=new a.LoggingPane(b,MochiKit.Logging.logger)}return a._loggingPane};MochiKit.LoggingPane.LoggingPane=function(L,I){if(typeof(I)=="undefined"||I===null){I=MochiKit.Logging.logger}this.logger=I;var H=MochiKit.Base.update;var h=MochiKit.Base.updatetree;var d=MochiKit.Base.bind;var g=MochiKit.Base.clone;var A=window;var e="_MochiKit_LoggingPane";if(typeof(MochiKit.DOM)!="undefined"){A=MochiKit.DOM.currentWindow()}if(!L){var c=A.location.href.split("?")[0].replace(/[#:\/.><&-]/g,"_");var k=e+"_"+c;var K=A.open("",k,"dependent,resizable,height=200");if(!K){alert("Not able to open debugging window due to pop-up blocking.");return undefined}K.document.write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[MochiKit.LoggingPane]</title></head><body></body></html>');K.document.close();K.document.title+=" "+A.document.title;A=K}var f=A.document;this.doc=f;var b=f.getElementById(e);var x=!!b;if(b&&typeof(b.loggingPane)!="undefined"){b.loggingPane.logger=this.logger;b.loggingPane.buildAndApplyFilter();return b.loggingPane}if(x){var w;while((w=b.firstChild)){b.removeChild(w)}}else{b=f.createElement("div");b.id=e}b.loggingPane=this;var v=f.createElement("input");var u=f.createElement("input");var t=f.createElement("button");var s=f.createElement("button");var G=f.createElement("button");var F=f.createElement("button");var E=f.createElement("div");var D=f.createElement("div");var C=e+"_Listener";this.colorTable=g(this.colorTable);var B=[];var z=null;var y=function(P){var O=P.level;if(typeof(O)=="number"){O=MochiKit.Logging.LogLevel[O]}return O};var m=function(O){return O.info.join(" ")};var l=d(function(R){var P=y(R);var Q=m(R);var S=this.colorTable[P];var O=f.createElement("span");O.className="MochiKit-LogMessage MochiKit-LogLevel-"+P;O.style.cssText="margin: 0px; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; white-space: pre-wrap; white-space: pre-line; word-wrap: break-word; wrap-option: emergency; color: "+S;O.appendChild(f.createTextNode(P+": "+Q));D.appendChild(O);D.appendChild(f.createElement("br"));if(E.offsetHeight>E.scrollHeight){E.scrollTop=0}else{E.scrollTop=E.scrollHeight}},this);var r=function(O){B[B.length]=O;l(O)};var q=function(){var P,O;try{P=new RegExp(v.value);O=new RegExp(u.value)}catch(Q){logDebug("Error in filter regex: "+Q.message);return null}return function(R){return(P.test(y(R))&&O.test(m(R)))}};var o=function(){while(D.firstChild){D.removeChild(D.firstChild)}};var n=function(){B=[];o()};var a=d(function(){if(this.closed){return}this.closed=true;if(MochiKit.LoggingPane._loggingPane==this){MochiKit.LoggingPane._loggingPane=null}this.logger.removeListener(C);try{try{b.loggingPane=null}catch(O){logFatal("Bookmarklet was closed incorrectly.")}if(L){b.parentNode.removeChild(b)}else{this.win.close()}}catch(O){}},this);var N=function(){o();for(var O=0;O<B.length;O++){var P=B[O];if(z===null||z(P)){l(P)}}};this.buildAndApplyFilter=function(){z=q();N();this.logger.removeListener(C);this.logger.addListener(C,z,r)};var M=d(function(){B=this.logger.getMessages();N()},this);var J=d(function(O){O=O||window.event;key=O.which||O.keyCode;if(key==13){this.buildAndApplyFilter()}},this);var j="display: block; z-index: 1000; left: 0px; bottom: 0px; position: fixed; width: 100%; background-color: white; font: "+this.logFont;if(L){j+="; height: 10em; border-top: 2px solid black"}else{j+="; height: 100%;"}b.style.cssText=j;if(!x){f.body.appendChild(b)}j={cssText:"width: 33%; display: inline; font: "+this.logFont};h(v,{value:"FATAL|ERROR|WARNING|INFO|DEBUG",onkeypress:J,style:j});b.appendChild(v);h(u,{value:".*",onkeypress:J,style:j});b.appendChild(u);j="width: 8%; display:inline; font: "+this.logFont;t.appendChild(f.createTextNode("Filter"));t.onclick=d("buildAndApplyFilter",this);t.style.cssText=j;b.appendChild(t);s.appendChild(f.createTextNode("Load"));s.onclick=M;s.style.cssText=j;b.appendChild(s);G.appendChild(f.createTextNode("Clear"));G.onclick=n;G.style.cssText=j;b.appendChild(G);F.appendChild(f.createTextNode("Close"));F.onclick=a;F.style.cssText=j;b.appendChild(F);E.style.cssText="overflow: auto; width: 100%";D.style.cssText="width: 100%; height: "+(L?"8em":"100%");E.appendChild(D);b.appendChild(E);this.buildAndApplyFilter();M();if(L){this.win=undefined}else{this.win=A}this.inline=L;this.closePane=a;this.closed=false;return this};MochiKit.LoggingPane.LoggingPane.prototype={logFont:"8pt Verdana,sans-serif",colorTable:{ERROR:"red",FATAL:"darkred",WARNING:"blue",INFO:"black",DEBUG:"green"}};MochiKit.LoggingPane.EXPORT_OK=["LoggingPane"];MochiKit.LoggingPane.EXPORT=["createLoggingPane"];MochiKit.LoggingPane.__new__=function(){this.EXPORT_TAGS={":common":this.EXPORT,":all":MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)};MochiKit.Base.nameFunctions(this);MochiKit.LoggingPane._loggingPane=null};MochiKit.LoggingPane.__new__();MochiKit.Base._exportSymbols(this,MochiKit.LoggingPane);MochiKit.Base._deps("Color",["Base","DOM","Style"]);MochiKit.Color.NAME="MochiKit.Color";MochiKit.Color.VERSION="1.4";MochiKit.Color.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Color.toString=function(){return this.__repr__()};MochiKit.Color.Color=function(d,c,a,b){if(typeof(b)=="undefined"||b===null){b=1}this.rgb={r:d,g:c,b:a,a:b}};MochiKit.Color.Color.prototype={__class__:MochiKit.Color.Color,colorWithAlpha:function(c){var b=this.rgb;var a=MochiKit.Color;return a.Color.fromRGB(b.r,b.g,b.b,c)},colorWithHue:function(c){var b=this.asHSL();b.h=c;var a=MochiKit.Color;return a.Color.fromHSL(b)},colorWithSaturation:function(c){var b=this.asHSL();b.s=c;var a=MochiKit.Color;return a.Color.fromHSL(b)},colorWithLightness:function(b){var c=this.asHSL();c.l=b;var a=MochiKit.Color;return a.Color.fromHSL(c)},darkerColorWithLevel:function(c){var b=this.asHSL();b.l=Math.max(b.l-c,0);var a=MochiKit.Color;return a.Color.fromHSL(b)},lighterColorWithLevel:function(c){var b=this.asHSL();b.l=Math.min(b.l+c,1);var a=MochiKit.Color;return a.Color.fromHSL(b)},blendedColor:function(b,a){if(typeof(a)=="undefined"||a===null){a=0.5}var e=1-a;var c=this.rgb;var g=b.rgb;var f=a;return MochiKit.Color.Color.fromRGB((c.r*e)+(g.r*f),(c.g*e)+(g.g*f),(c.b*e)+(g.b*f),(c.a*e)+(g.a*f))},compareRGB:function(e){var d=this.asRGB();var c=e.asRGB();return MochiKit.Base.compare([d.r,d.g,d.b,d.a],[c.r,c.g,c.b,c.a])},isLight:function(){return this.asHSL().b>0.5},isDark:function(){return(!this.isLight())},toHSLString:function(){var g=this.asHSL();var f=MochiKit.Color.clampColorComponent;var e=this._hslString;if(!e){var d=(f(g.h,360).toFixed(0)+","+f(g.s,100).toPrecision(4)+"%,"+f(g.l,100).toPrecision(4)+"%");var b=g.a;if(b>=1){b=1;e="hsl("+d+")"}else{if(b<=0){b=0}e="hsla("+d+","+b+")"}this._hslString=e}return e},toRGBString:function(){var e=this.rgb;var d=MochiKit.Color.clampColorComponent;var b=this._rgbString;if(!b){var a=(d(e.r,255).toFixed(0)+","+d(e.g,255).toFixed(0)+","+d(e.b,255).toFixed(0));if(e.a!=1){b="rgba("+a+","+e.a+")"}else{b="rgb("+a+")"}this._rgbString=b}return b},asRGB:function(){return MochiKit.Base.clone(this.rgb)},toHexString:function(){var a=MochiKit.Color;var e=this.rgb;var d=MochiKit.Color.clampColorComponent;var b=this._hexString;if(!b){b=("#"+a.toColorPart(d(e.r,255))+a.toColorPart(d(e.g,255))+a.toColorPart(d(e.b,255)));this._hexString=b}return b},asHSV:function(){var a=this.hsv;var b=this.rgb;if(typeof(a)=="undefined"||a===null){a=MochiKit.Color.rgbToHSV(this.rgb);this.hsv=a}return MochiKit.Base.clone(a)},asHSL:function(){var a=this.hsl;var b=this.rgb;if(typeof(a)=="undefined"||a===null){a=MochiKit.Color.rgbToHSL(this.rgb);this.hsl=a}return MochiKit.Base.clone(a)},toString:function(){return this.toRGBString()},repr:function(){var b=this.rgb;var a=[b.r,b.g,b.b,b.a];return this.__class__.NAME+"("+a.join(", ")+")"}};MochiKit.Base.update(MochiKit.Color.Color,{fromRGB:function(d,b,a,f){var e=MochiKit.Color.Color;if(arguments.length==1){var c=d;d=c.r;b=c.g;a=c.b;if(typeof(c.a)=="undefined"){f=undefined}else{f=c.a}}return new e(d,b,a,f)},fromHSL:function(c,b,e,d){var a=MochiKit.Color;return a.Color.fromRGB(a.hslToRGB.apply(a,arguments))},fromHSV:function(b,e,d,c){var a=MochiKit.Color;return a.Color.fromRGB(a.hsvToRGB.apply(a,arguments))},fromName:function(c){var b=MochiKit.Color.Color;if(c.charAt(0)=='"'){c=c.substr(1,c.length-2)}var a=b._namedColors[c.toLowerCase()];if(typeof(a)=="string"){return b.fromHexString(a)}else{if(c=="transparent"){return b.transparentColor()}}return null},fromString:function(a){var b=MochiKit.Color.Color;var c=a.substr(0,3);if(c=="rgb"){return b.fromRGBString(a)}else{if(c=="hsl"){return b.fromHSLString(a)}else{if(a.charAt(0)=="#"){return b.fromHexString(a)}}}return b.fromName(a)},fromHexString:function(b){if(b.charAt(0)=="#"){b=b.substring(1)}var a=[];var c,d;if(b.length==3){for(c=0;c<3;c++){d=b.substr(c,1);a.push(parseInt(d+d,16)/255)}}else{for(c=0;c<6;c+=2){d=b.substr(c,2);a.push(parseInt(d,16)/255)}}var e=MochiKit.Color.Color;return e.fromRGB.apply(e,a)},_fromColorString:function(d,k,j,h){if(h.indexOf(d)===0){h=h.substring(h.indexOf("(",3)+1,h.length-1)}var g=h.split(/\s*,\s*/);var f=[];for(var e=0;e<g.length;e++){var l=g[e];var a;var b=l.substring(l.length-3);if(l.charAt(l.length-1)=="%"){a=0.01*parseFloat(l.substring(0,l.length-1))}else{if(b=="deg"){a=parseFloat(l)/360}else{if(b=="rad"){a=parseFloat(l)/(Math.PI*2)}else{a=j[e]*parseFloat(l)}}}f.push(a)}return this[k].apply(this,f)},fromComputedStyle:function(f,e){var g=MochiKit.DOM;var b=MochiKit.Color.Color;for(f=g.getElement(f);f;f=f.parentNode){var c=MochiKit.Style.getStyle.apply(g,arguments);if(!c){continue}var a=b.fromString(c);if(!a){break}if(a.asRGB().a>0){return a}}return null},fromBackground:function(b){var a=MochiKit.Color.Color;return a.fromComputedStyle(b,"backgroundColor","background-color")||a.whiteColor()},fromText:function(b){var a=MochiKit.Color.Color;return a.fromComputedStyle(b,"color","color")||a.blackColor()},namedColors:function(){return MochiKit.Base.clone(MochiKit.Color.Color._namedColors)}});MochiKit.Base.update(MochiKit.Color,{clampColorComponent:function(a,b){a*=b;if(a<0){return 0}else{if(a>b){return b}else{return a}}},_hslValue:function(c,b,a){if(a>6){a-=6}else{if(a<0){a+=6}}var d;if(a<1){d=c+(b-c)*a}else{if(a<3){d=b}else{if(a<4){d=c+(b-c)*(4-a)}else{d=c}}}return d},hsvToRGB:function(k,e,d,b){if(arguments.length==1){var j=k;k=j.h;e=j.s;d=j.v;b=j.a}var g;var o;var m;if(e===0){g=d;o=d;m=d}else{var h=Math.floor(k*6);var l=(k*6)-h;var c=d*(1-e);var a=d*(1-(e*l));var n=d*(1-(e*(1-l)));switch(h){case 1:g=a;o=d;m=c;break;case 2:g=c;o=d;m=n;break;case 3:g=c;o=a;m=d;break;case 4:g=n;o=c;m=d;break;case 5:g=d;o=c;m=a;break;case 6:case 0:g=d;o=n;m=c;break}}return{r:g,g:o,b:m,a:b}},hslToRGB:function(c,h,g,e){if(arguments.length==1){var m=c;c=m.h;h=m.s;g=m.l;e=m.a}var a;var j;var k;if(h===0){a=g;j=g;k=g}else{var l;if(g<=0.5){l=g*(1+h)}else{l=g+h-(g*h)}var n=(2*g)-l;var d=MochiKit.Color._hslValue;var b=c*6;a=d(n,l,b+2);j=d(n,l,b);k=d(n,l,b-2)}return{r:a,g:j,b:k,a:e}},rgbToHSV:function(a,k,l,f){if(arguments.length==1){var d=a;a=d.r;k=d.g;l=d.b;f=d.a}var g=Math.max(Math.max(a,k),l);var b=Math.min(Math.min(a,k),l);var c;var j;var h=g;if(b==g){c=0;j=0}else{var e=(g-b);j=e/g;if(a==g){c=(k-l)/e}else{if(k==g){c=2+((l-a)/e)}else{c=4+((a-k)/e)}}c/=6;if(c<0){c+=1}if(c>1){c-=1}}return{h:c,s:j,v:h,a:f}},rgbToHSL:function(b,h,l,g){if(arguments.length==1){var j=b;b=j.r;h=j.g;l=j.b;g=j.a}var k=Math.max(b,Math.max(h,l));var e=Math.min(b,Math.min(h,l));var f;var d;var c=(k+e)/2;var a=k-e;if(a===0){f=0;d=0}else{if(c<=0.5){d=a/(k+e)}else{d=a/(2-k-e)}if(b==k){f=(h-l)/a}else{if(h==k){f=2+((l-b)/a)}else{f=4+((b-h)/a)}}f/=6;if(f<0){f+=1}if(f>1){f-=1}}return{h:f,s:d,l:c,a:g}},toColorPart:function(a){a=Math.round(a);var b=a.toString(16);if(a<16){return"0"+b}return b},__new__:function(){var b=MochiKit.Base;this.Color.fromRGBString=b.bind(this.Color._fromColorString,this.Color,"rgb","fromRGB",[1/255,1/255,1/255,1]);this.Color.fromHSLString=b.bind(this.Color._fromColorString,this.Color,"hsl","fromHSL",[1/360,0.01,0.01,1]);var f=1/3;var e={black:[0,0,0],blue:[0,0,1],brown:[0.6,0.4,0.2],cyan:[0,1,1],darkGray:[f,f,f],gray:[0.5,0.5,0.5],green:[0,1,0],lightGray:[2*f,2*f,2*f],magenta:[1,0,1],orange:[1,0.5,0],purple:[0.5,0,0.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]};var c=function(m,o,n,k,l){var q=this.fromRGB(o,n,k,l);this[m]=function(){return q};return q};for(var d in e){var a=d+"Color";var j=b.concat([c,this.Color,a],e[d]);this.Color[a]=b.bind.apply(null,j)}var h=function(){for(var k=0;k<arguments.length;k++){if(!(arguments[k] instanceof MochiKit.Color.Color)){return false}}return true};var g=function(l,k){return l.compareRGB(k)};b.nameFunctions(this);b.registerComparator(this.Color.NAME,h,g);this.EXPORT_TAGS={":common":this.EXPORT,":all":b.concat(this.EXPORT,this.EXPORT_OK)}}});MochiKit.Color.EXPORT=["Color"];MochiKit.Color.EXPORT_OK=["clampColorComponent","rgbToHSL","hslToRGB","rgbToHSV","hsvToRGB","toColorPart"];MochiKit.Color.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Color);MochiKit.Color.Color._namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};MochiKit.Base._deps("Signal",["Base","DOM","Style"]);MochiKit.Signal.NAME="MochiKit.Signal";MochiKit.Signal.VERSION="1.4";MochiKit.Signal._observers=[];MochiKit.Signal.Event=function(b,a){this._event=a||window.event;this._src=b};MochiKit.Base.update(MochiKit.Signal.Event.prototype,{__repr__:function(){var a=MochiKit.Base.repr;var b="{event(): "+a(this.event())+", src(): "+a(this.src())+", type(): "+a(this.type())+", target(): "+a(this.target());if(this.type()&&this.type().indexOf("key")===0||this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu"){b+=", modifier(): {alt: "+a(this.modifier().alt)+", ctrl: "+a(this.modifier().ctrl)+", meta: "+a(this.modifier().meta)+", shift: "+a(this.modifier().shift)+", any: "+a(this.modifier().any)+"}"}if(this.type()&&this.type().indexOf("key")===0){b+=", key(): {code: "+a(this.key().code)+", string: "+a(this.key().string)+"}"}if(this.type()&&(this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")){b+=", mouse(): {page: "+a(this.mouse().page)+", client: "+a(this.mouse().client);if(this.type()!="mousemove"){b+=", button: {left: "+a(this.mouse().button.left)+", middle: "+a(this.mouse().button.middle)+", right: "+a(this.mouse().button.right)+"}}"}else{b+="}"}}if(this.type()=="mouseover"||this.type()=="mouseout"||this.type()=="mouseenter"||this.type()=="mouseleave"){b+=", relatedTarget(): "+a(this.relatedTarget())}b+="}";return b},toString:function(){return this.__repr__()},src:function(){return this._src},event:function(){return this._event},type:function(){return this._event.type||undefined},target:function(){return this._event.target||this._event.srcElement},_relatedTarget:null,relatedTarget:function(){if(this._relatedTarget!==null){return this._relatedTarget}var a=null;if(this.type()=="mouseover"||this.type()=="mouseenter"){a=(this._event.relatedTarget||this._event.fromElement)}else{if(this.type()=="mouseout"||this.type()=="mouseleave"){a=(this._event.relatedTarget||this._event.toElement)}}if(a!==null){this._relatedTarget=a;return a}return undefined},_modifier:null,modifier:function(){if(this._modifier!==null){return this._modifier}var a={};a.alt=this._event.altKey;a.ctrl=this._event.ctrlKey;a.meta=this._event.metaKey||false;a.shift=this._event.shiftKey;a.any=a.alt||a.ctrl||a.shift||a.meta;this._modifier=a;return a},_key:null,key:function(){if(this._key!==null){return this._key}var a={};if(this.type()&&this.type().indexOf("key")===0){if(this.type()=="keydown"||this.type()=="keyup"){a.code=this._event.keyCode;a.string=(MochiKit.Signal._specialKeys[a.code]||"KEY_UNKNOWN");this._key=a;return a}else{if(this.type()=="keypress"){a.code=0;a.string="";if(typeof(this._event.charCode)!="undefined"&&this._event.charCode!==0&&!MochiKit.Signal._specialMacKeys[this._event.charCode]){a.code=this._event.charCode;a.string=String.fromCharCode(a.code)}else{if(this._event.keyCode&&typeof(this._event.charCode)=="undefined"){a.code=this._event.keyCode;a.string=String.fromCharCode(a.code)}}this._key=a;return a}}}return undefined},_mouse:null,mouse:function(){if(this._mouse!==null){return this._mouse}var c={};var d=this._event;if(this.type()&&(this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")){c.client=new MochiKit.Style.Coordinates(0,0);if(d.clientX||d.clientY){c.client.x=(!d.clientX||d.clientX<0)?0:d.clientX;c.client.y=(!d.clientY||d.clientY<0)?0:d.clientY}c.page=new MochiKit.Style.Coordinates(0,0);if(d.pageX||d.pageY){c.page.x=(!d.pageX||d.pageX<0)?0:d.pageX;c.page.y=(!d.pageY||d.pageY<0)?0:d.pageY}else{var f=MochiKit.DOM._document.documentElement;var a=MochiKit.DOM._document.body;c.page.x=d.clientX+(f.scrollLeft||a.scrollLeft)-(f.clientLeft||0);c.page.y=d.clientY+(f.scrollTop||a.scrollTop)-(f.clientTop||0)}if(this.type()!="mousemove"){c.button={};c.button.left=false;c.button.right=false;c.button.middle=false;if(d.which){c.button.left=(d.which==1);c.button.middle=(d.which==2);c.button.right=(d.which==3)}else{c.button.left=!!(d.button&1);c.button.right=!!(d.button&2);c.button.middle=!!(d.button&4)}}this._mouse=c;return c}return undefined},stop:function(){this.stopPropagation();this.preventDefault()},stopPropagation:function(){if(this._event.stopPropagation){this._event.stopPropagation()}else{this._event.cancelBubble=true}},preventDefault:function(){if(this._event.preventDefault){this._event.preventDefault()}else{if(this._confirmUnload===null){this._event.returnValue=false}}},_confirmUnload:null,confirmUnload:function(a){if(this.type()=="beforeunload"){this._confirmUnload=a;this._event.returnValue=a}}});MochiKit.Signal._specialMacKeys={3:"KEY_ENTER",63289:"KEY_NUM_PAD_CLEAR",63276:"KEY_PAGE_UP",63277:"KEY_PAGE_DOWN",63275:"KEY_END",63273:"KEY_HOME",63234:"KEY_ARROW_LEFT",63232:"KEY_ARROW_UP",63235:"KEY_ARROW_RIGHT",63233:"KEY_ARROW_DOWN",63302:"KEY_INSERT",63272:"KEY_DELETE"};(function(){var a=MochiKit.Signal._specialMacKeys;for(i=63236;i<=63242;i++){a[i]="KEY_F"+(i-63236+1)}})();MochiKit.Signal._specialKeys={8:"KEY_BACKSPACE",9:"KEY_TAB",12:"KEY_NUM_PAD_CLEAR",13:"KEY_ENTER",16:"KEY_SHIFT",17:"KEY_CTRL",18:"KEY_ALT",19:"KEY_PAUSE",20:"KEY_CAPS_LOCK",27:"KEY_ESCAPE",32:"KEY_SPACEBAR",33:"KEY_PAGE_UP",34:"KEY_PAGE_DOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_ARROW_LEFT",38:"KEY_ARROW_UP",39:"KEY_ARROW_RIGHT",40:"KEY_ARROW_DOWN",44:"KEY_PRINT_SCREEN",45:"KEY_INSERT",46:"KEY_DELETE",59:"KEY_SEMICOLON",91:"KEY_WINDOWS_LEFT",92:"KEY_WINDOWS_RIGHT",93:"KEY_SELECT",106:"KEY_NUM_PAD_ASTERISK",107:"KEY_NUM_PAD_PLUS_SIGN",109:"KEY_NUM_PAD_HYPHEN-MINUS",110:"KEY_NUM_PAD_FULL_STOP",111:"KEY_NUM_PAD_SOLIDUS",144:"KEY_NUM_LOCK",145:"KEY_SCROLL_LOCK",186:"KEY_SEMICOLON",187:"KEY_EQUALS_SIGN",188:"KEY_COMMA",189:"KEY_HYPHEN-MINUS",190:"KEY_FULL_STOP",191:"KEY_SOLIDUS",192:"KEY_GRAVE_ACCENT",219:"KEY_LEFT_SQUARE_BRACKET",220:"KEY_REVERSE_SOLIDUS",221:"KEY_RIGHT_SQUARE_BRACKET",222:"KEY_APOSTROPHE"};(function(){var b=MochiKit.Signal._specialKeys;for(var a=48;a<=57;a++){b[a]="KEY_"+(a-48)}for(a=65;a<=90;a++){b[a]="KEY_"+String.fromCharCode(a)}for(a=96;a<=105;a++){b[a]="KEY_NUM_PAD_"+(a-96)}for(a=112;a<=123;a++){b[a]="KEY_F"+(a-112+1)}})();MochiKit.Signal.Ident=function(a){this.source=a.source;this.signal=a.signal;this.listener=a.listener;this.isDOM=a.isDOM;this.objOrFunc=a.objOrFunc;this.funcOrStr=a.funcOrStr;this.connected=a.connected};MochiKit.Signal.Ident.prototype={};MochiKit.Base.update(MochiKit.Signal,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},_unloadCache:function(){var a=MochiKit.Signal;var c=a._observers;for(var b=0;b<c.length;b++){if(c[b].signal!=="onload"&&c[b].signal!=="onunload"){a._disconnect(c[b])}}},_listener:function(g,f,c,e,b){var a=MochiKit.Signal;var d=a.Event;if(!b){if(typeof(c.im_self)=="undefined"){return MochiKit.Base.bind(c,e)}else{return c}}e=e||g;if(typeof(c)=="string"){if(f==="onload"||f==="onunload"){return function(j){e[c].apply(e,[new d(g,j)]);var h=new MochiKit.Signal.Ident({source:g,signal:f,objOrFunc:e,funcOrStr:c});MochiKit.Signal._disconnect(h)}}else{return function(h){e[c].apply(e,[new d(g,h)])}}}else{if(f==="onload"||f==="onunload"){return function(h){c.apply(e,[new d(g,h)]);var j=new MochiKit.Signal.Ident({source:g,signal:f,objOrFunc:c});MochiKit.Signal._disconnect(j)}}else{return function(h){c.apply(e,[new d(g,h)])}}}},_browserAlreadyHasMouseEnterAndLeave:function(){return/MSIE/.test(navigator.userAgent)},_mouseEnterListener:function(e,d,a,c){var b=MochiKit.Signal.Event;return function(h){var g=new b(e,h);try{g.relatedTarget().nodeName}catch(f){return}g.stop();if(MochiKit.DOM.isChildNode(g.relatedTarget(),e)){return}g.type=function(){return d};if(typeof(a)=="string"){return c[a].apply(c,[g])}else{return a.apply(c,[g])}}},_getDestPair:function(d,b){var c=null;var a=null;if(typeof(b)!="undefined"){c=d;a=b;if(typeof(b)=="string"){if(typeof(d[b])!="function"){throw new Error("'funcOrStr' must be a function on 'objOrFunc'")}}else{if(typeof(b)!="function"){throw new Error("'funcOrStr' must be a function or string")}}}else{if(typeof(d)!="function"){throw new Error("'objOrFunc' must be a function if 'funcOrStr' is not given")}else{a=d}}return[c,a]},connect:function(a,l,g,b){a=MochiKit.DOM.getElement(a);var k=MochiKit.Signal;if(typeof(l)!="string"){throw new Error("'sig' must be a string")}var m=k._getDestPair(g,b);var d=m[0];var c=m[1];if(typeof(d)=="undefined"||d===null){d=a}var j=!!(a.addEventListener||a.attachEvent);if(j&&(l==="onmouseenter"||l==="onmouseleave")&&!k._browserAlreadyHasMouseEnterAndLeave()){var h=k._mouseEnterListener(a,l.substr(2),c,d);if(l==="onmouseenter"){l="onmouseover"}else{l="onmouseout"}}else{var h=k._listener(a,l,c,d,j)}if(a.addEventListener){a.addEventListener(l.substr(2),h,false)}else{if(a.attachEvent){a.attachEvent(l,h)}}var f=new MochiKit.Signal.Ident({source:a,signal:l,listener:h,isDOM:j,objOrFunc:g,funcOrStr:b,connected:true});k._observers.push(f);if(!j&&typeof(a.__connect__)=="function"){var e=MochiKit.Base.extend([f],arguments,1);a.__connect__.apply(a,e)}return f},_disconnect:function(d){if(!d.connected){return}d.connected=false;if(!d.isDOM){return}var c=d.source;var b=d.signal;var a=d.listener;if(c.removeEventListener){c.removeEventListener(b.substr(2),a,false)}else{if(c.detachEvent){c.detachEvent(b,a)}else{throw new Error("'src' must be a DOM element")}}},disconnect:function(h){var k=MochiKit.Signal;var g=k._observers;var d=MochiKit.Base;if(arguments.length>1){var a=MochiKit.DOM.getElement(arguments[0]);var l=arguments[1];var f=arguments[2];var c=arguments[3];for(var e=g.length-1;e>=0;e--){var b=g[e];if(b.source===a&&b.signal===l&&b.objOrFunc===f&&b.funcOrStr===c){k._disconnect(b);if(!k._lock){g.splice(e,1)}else{k._dirty=true}return true}}}else{var j=d.findIdentical(g,h);if(j>=0){k._disconnect(h);if(!k._lock){g.splice(j,1)}else{k._dirty=true}return true}}return false},disconnectAllTo:function(h,f){var j=MochiKit.Signal;var d=j._observers;var c=j._disconnect;var b=j._lock;var a=j._dirty;if(typeof(f)==="undefined"){f=null}for(var g=d.length-1;g>=0;g--){var e=d[g];if(e.objOrFunc===h&&(f===null||e.funcOrStr===f)){c(e);if(b){a=true}else{d.splice(g,1)}}}j._dirty=a},disconnectAll:function(b,n){b=MochiKit.DOM.getElement(b);var f=MochiKit.Base;var e=f.flattenArguments(f.extend(null,arguments,1));var j=MochiKit.Signal;var d=j._disconnect;var c=j._observers;var g,a;var l=j._lock;var h=j._dirty;if(e.length===0){for(g=c.length-1;g>=0;g--){a=c[g];if(a.source===b){d(a);if(!l){c.splice(g,1)}else{h=true}}}}else{var k={};for(g=0;g<e.length;g++){k[e[g]]=true}for(g=c.length-1;g>=0;g--){a=c[g];if(a.source===b&&a.signal in k){d(a);if(!l){c.splice(g,1)}else{h=true}}}}j._dirty=h},signal:function(a,k){var j=MochiKit.Signal;var b=j._observers;a=MochiKit.DOM.getElement(a);var f=MochiKit.Base.extend(null,arguments,2);var h=[];j._lock=true;for(var c=0;c<b.length;c++){var g=b[c];if(g.source===a&&g.signal===k&&g.connected){try{g.listener.apply(a,f)}catch(d){h.push(d)}}}j._lock=false;if(j._dirty){j._dirty=false;for(var c=b.length-1;c>=0;c--){if(!b[c].connected){b.splice(c,1)}}}if(h.length==1){throw h[0]}else{if(h.length>1){var d=new Error("Multiple errors thrown in handling 'sig', see errors property");d.errors=h;throw d}}}});MochiKit.Signal.EXPORT_OK=[];MochiKit.Signal.EXPORT=["connect","disconnect","signal","disconnectAll","disconnectAllTo"];MochiKit.Signal.__new__=function(c){var a=MochiKit.Base;this._document=document;this._window=c;this._lock=false;this._dirty=false;try{this.connect(window,"onunload",this._unloadCache)}catch(b){}this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};MochiKit.Signal.__new__(this);if(MochiKit.__export__){connect=MochiKit.Signal.connect;disconnect=MochiKit.Signal.disconnect;disconnectAll=MochiKit.Signal.disconnectAll;signal=MochiKit.Signal.signal}MochiKit.Base._exportSymbols(this,MochiKit.Signal);MochiKit.Base._deps("Position",["Base","DOM","Style"]);MochiKit.Position.NAME="MochiKit.Position";MochiKit.Position.VERSION="1.4";MochiKit.Position.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Position.toString=function(){return this.__repr__()};MochiKit.Position.EXPORT_OK=[];MochiKit.Position.EXPORT=[];MochiKit.Base.update(MochiKit.Position,{includeScrollOffsets:false,prepare:function(){var b=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;this.windowOffset=new MochiKit.Style.Coordinates(b,a)},cumulativeOffset:function(c){var b=0;var a=0;do{b+=c.offsetTop||0;a+=c.offsetLeft||0;c=c.offsetParent}while(c);return new MochiKit.Style.Coordinates(a,b)},realOffset:function(b){var a=0;var c=0;do{a+=b.scrollTop||0;c+=b.scrollLeft||0;b=b.parentNode}while(b);return new MochiKit.Style.Coordinates(c,a)},within:function(b,a,c){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,c)}this.xcomp=a;this.ycomp=c;this.offset=this.cumulativeOffset(b);if(b.style.position=="fixed"){this.offset.x+=this.windowOffset.x;this.offset.y+=this.windowOffset.y}return(c>=this.offset.y&&c<this.offset.y+b.offsetHeight&&a>=this.offset.x&&a<this.offset.x+b.offsetWidth)},withinIncludingScrolloffsets:function(c,b,d){var a=this.realOffset(c);this.xcomp=b+a.x-this.windowOffset.x;this.ycomp=d+a.y-this.windowOffset.y;this.offset=this.cumulativeOffset(c);return(this.ycomp>=this.offset.y&&this.ycomp<this.offset.y+c.offsetHeight&&this.xcomp>=this.offset.x&&this.xcomp<this.offset.x+c.offsetWidth)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset.y+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset.x+a.offsetWidth)-this.xcomp)/a.offsetWidth}},absolutize:function(e){e=MochiKit.DOM.getElement(e);if(e.style.position=="absolute"){return}MochiKit.Position.prepare();var d=MochiKit.Position.positionedOffset(e);var c=e.clientWidth;var b=e.clientHeight;var a={position:e.style.position,left:d.x-parseFloat(e.style.left||0),top:d.y-parseFloat(e.style.top||0),width:e.style.width,height:e.style.height};e.style.position="absolute";e.style.top=d.y+"px";e.style.left=d.x+"px";e.style.width=c+"px";e.style.height=b+"px";return a},positionedOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent;if(b){p=MochiKit.Style.getStyle(b,"position");if(p=="relative"||p=="absolute"){break}}}while(b);return new MochiKit.Style.Coordinates(c,a)},relativize:function(b,a){b=MochiKit.DOM.getElement(b);if(b.style.position=="relative"){return}MochiKit.Position.prepare();var d=parseFloat(b.style.top||0)-(a.top||0);var c=parseFloat(b.style.left||0)-(a.left||0);b.style.position=a.position;b.style.top=d+"px";b.style.left=c+"px";b.style.width=a.width;b.style.height=a.height},clone:function(b,c){b=MochiKit.DOM.getElement(b);c=MochiKit.DOM.getElement(c);c.style.position="absolute";var a=this.cumulativeOffset(b);c.style.top=a.y+"px";c.style.left=a.x+"px";c.style.width=b.offsetWidth+"px";c.style.height=b.offsetHeight+"px"},page:function(a){var d=0;var c=0;var b=a;do{d+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body&&MochiKit.Style.getStyle(b,"position")=="absolute"){break}}while(b=b.offsetParent);b=a;do{d-=b.scrollTop||0;c-=b.scrollLeft||0}while(b=b.parentNode);return new MochiKit.Style.Coordinates(c,d)}});MochiKit.Position.__new__=function(b){var a=MochiKit.Base;this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};MochiKit.Position.__new__(this);MochiKit.Base._deps("Visual",["Base","DOM","Style","Color","Position"]);MochiKit.Visual.NAME="MochiKit.Visual";MochiKit.Visual.VERSION="1.4";MochiKit.Visual.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Visual.toString=function(){return this.__repr__()};MochiKit.Visual._RoundCorners=function(d,a){d=MochiKit.DOM.getElement(d);this._setOptions(a);if(this.options.__unstable__wrapElement){d=this._doWrap(d)}var c=this.options.color;var f=MochiKit.Color.Color;if(this.options.color==="fromElement"){c=f.fromBackground(d)}else{if(!(c instanceof f)){c=f.fromString(c)}}this.isTransparent=(c.asRGB().a<=0);var b=this.options.bgColor;if(this.options.bgColor==="fromParent"){b=f.fromBackground(d.offsetParent)}else{if(!(b instanceof f)){b=f.fromString(b)}}this._roundCornersImpl(d,c,b)};MochiKit.Visual._RoundCorners.prototype={_doWrap:function(f){var c=f.parentNode;var d=MochiKit.DOM.currentDocument();if(typeof(d.defaultView)==="undefined"||d.defaultView===null){return f}var b=d.defaultView.getComputedStyle(f,null);if(typeof(b)==="undefined"||b===null){return f}var a=MochiKit.DOM.DIV({style:{display:"block",marginTop:b.getPropertyValue("padding-top"),marginRight:b.getPropertyValue("padding-right"),marginBottom:b.getPropertyValue("padding-bottom"),marginLeft:b.getPropertyValue("padding-left"),padding:"0px"}});a.innerHTML=f.innerHTML;f.innerHTML="";f.appendChild(a);return f},_roundCornersImpl:function(c,b,a){if(this.options.border){this._renderBorder(c,a)}if(this._isTopRounded()){this._roundTopCorners(c,b,a)}if(this._isBottomRounded()){this._roundBottomCorners(c,b,a)}},_renderBorder:function(a,e){var d="1px solid "+this._borderColor(e);var c="border-left: "+d;var b="border-right: "+d;var f="style='"+c+";"+b+"'";a.innerHTML="<div "+f+">"+a.innerHTML+"</div>"},_roundTopCorners:function(b,e,d){var c=this._createCorner(d);for(var a=0;a<this.options.numSlices;a++){c.appendChild(this._createCornerSlice(e,d,a,"top"))}b.style.paddingTop=0;b.insertBefore(c,b.firstChild)},_roundBottomCorners:function(e,d,c){var a=this._createCorner(c);for(var b=(this.options.numSlices-1);b>=0;b--){a.appendChild(this._createCornerSlice(d,c,b,"bottom"))}e.style.paddingBottom=0;e.appendChild(a)},_createCorner:function(a){var b=MochiKit.DOM;return b.DIV({style:{backgroundColor:a.toString()}})},_createCornerSlice:function(g,d,f,b){var a=MochiKit.DOM.SPAN();var e=a.style;e.backgroundColor=g.toString();e.display="block";e.height="1px";e.overflow="hidden";e.fontSize="1px";var c=this._borderColor(g,d);if(this.options.border&&f===0){e.borderTopStyle="solid";e.borderTopWidth="1px";e.borderLeftWidth="0px";e.borderRightWidth="0px";e.borderBottomWidth="0px";e.height="0px";e.borderColor=c.toString()}else{if(c){e.borderColor=c.toString();e.borderStyle="solid";e.borderWidth="0px 1px"}}if(!this.options.compact&&(f==(this.options.numSlices-1))){e.height="2px"}this._setMargin(a,f,b);this._setBorder(a,f,b);return a},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false,__unstable__wrapElement:false};MochiKit.Base.update(this.options,a);this.options.numSlices=(this.options.compact?2:4)},_whichSideTop:function(){var b=this.options.corners;if(this._hasString(b,"all","top")){return""}var c=(b.indexOf("tl")!=-1);var a=(b.indexOf("tr")!=-1);if(c&&a){return""}if(c){return"left"}if(a){return"right"}return""},_whichSideBottom:function(){var c=this.options.corners;if(this._hasString(c,"all","bottom")){return""}var b=(c.indexOf("bl")!=-1);var a=(c.indexOf("br")!=-1);if(b&&a){return""}if(b){return"left"}if(a){return"right"}return""},_borderColor:function(b,a){if(b=="transparent"){return a}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return a.blendedColor(b)}}}return""},_setMargin:function(d,f,e){var c=this._marginSize(f)+"px";var b=(e=="top"?this._whichSideTop():this._whichSideBottom());var a=d.style;if(b=="left"){a.marginLeft=c;a.marginRight="0px"}else{if(b=="right"){a.marginRight=c;a.marginLeft="0px"}else{a.marginLeft=c;a.marginRight=c}}},_setBorder:function(a,f,d){var e=this._borderSize(f)+"px";var c=(d=="top"?this._whichSideTop():this._whichSideBottom());var b=a.style;if(c=="left"){b.borderLeftWidth=e;b.borderRightWidth="0px"}else{if(c=="right"){b.borderRightWidth=e;b.borderLeftWidth="0px"}else{b.borderLeftWidth=e;b.borderRightWidth=e}}},_marginSize:function(f){if(this.isTransparent){return 0}var e=this.options;if(e.compact&&e.blend){var d=[1,0];return d[f]}else{if(e.compact){var c=[2,1];return c[f]}else{if(e.blend){var b=[3,2,1,0];return b[f]}else{var a=[5,3,2,1];return a[f]}}}},_borderSize:function(c){var b=this.options;var a;if(b.compact&&(b.blend||this.isTransparent)){return 1}else{if(b.compact){a=[1,0]}else{if(b.blend){a=[2,1,1,1]}else{if(b.border){a=[0,2,0,0]}else{if(this.isTransparent){a=[5,3,2,1]}else{return 0}}}}}return a[c]},_hasString:function(b){for(var a=1;a<arguments.length;a++){if(b.indexOf(arguments[a])!=-1){return true}}return false},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return(a.childNodes.length==1&&a.childNodes[0].nodeType==3)}};MochiKit.Visual.roundElement=function(b,a){new MochiKit.Visual._RoundCorners(b,a)};MochiKit.Visual.roundClass=function(e,d,c){var b=MochiKit.DOM.getElementsByTagAndClassName(e,d);for(var a=0;a<b.length;a++){MochiKit.Visual.roundElement(b[a],c)}};MochiKit.Visual.tagifyText=function(b,a){a=a||"position:relative";if(/MSIE/.test(navigator.userAgent)){a+=";zoom:1"}b=MochiKit.DOM.getElement(b);var c=MochiKit.Base.map;c(function(d){if(d.nodeType==3){c(function(e){b.insertBefore(MochiKit.DOM.SPAN({style:a},e==" "?String.fromCharCode(160):e),d)},d.nodeValue.split(""));MochiKit.DOM.removeElement(d)}},b.childNodes)};MochiKit.Visual.forceRerendering=function(a){try{a=MochiKit.DOM.getElement(a);var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(b){}};MochiKit.Visual.multiple=function(a,e,c){c=MochiKit.Base.update({speed:0.1,delay:0},c);var d=c.delay;var b=0;MochiKit.Base.map(function(f){c.delay=b*c.speed+d;new e(f,c);b+=1},a)};MochiKit.Visual.PAIRS={slide:["slideDown","slideUp"],blind:["blindDown","blindUp"],appear:["appear","fade"],size:["grow","shrink"]};MochiKit.Visual.toggle=function(d,c,b){d=MochiKit.DOM.getElement(d);c=(c||"appear").toLowerCase();b=MochiKit.Base.update({queue:{position:"end",scope:(d.id||"global"),limit:1}},b);var a=MochiKit.Visual;a[MochiKit.Style.getStyle(d,"display")!="none"?a.PAIRS[c][1]:a.PAIRS[c][0]](d,b)};MochiKit.Visual.Transitions={};MochiKit.Visual.Transitions.linear=function(a){return a};MochiKit.Visual.Transitions.sinoidal=function(a){return(-Math.cos(a*Math.PI)/2)+0.5};MochiKit.Visual.Transitions.reverse=function(a){return 1-a};MochiKit.Visual.Transitions.flicker=function(a){return((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4};MochiKit.Visual.Transitions.wobble=function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5};MochiKit.Visual.Transitions.pulse=function(b,a){if(!a){return(Math.floor(b*10)%2===0?(b*10-Math.floor(b*10)):1-(b*10-Math.floor(b*10)))}return(Math.round((b%(1/a))*a)==0?((b*a*2)-Math.floor(b*a*2)):1-((b*a*2)-Math.floor(b*a*2)))};MochiKit.Visual.Transitions.none=function(a){return 0};MochiKit.Visual.Transitions.full=function(a){return 1};MochiKit.Visual.ScopedQueue=function(){var a=arguments.callee;if(!(this instanceof a)){return new a()}this.__init__()};MochiKit.Base.update(MochiKit.Visual.ScopedQueue.prototype,{__init__:function(){this.effects=[];this.interval=null},add:function(a){var e=new Date().getTime();var c=(typeof(a.options.queue)=="string")?a.options.queue:a.options.queue.position;var d=MochiKit.Base.map;switch(c){case"front":d(function(f){if(f.state=="idle"){f.startOn+=a.finishOn;f.finishOn+=a.finishOn}},this.effects);break;case"end":var b;d(function(g){var f=g.finishOn;if(f>=(b||f)){b=f}},this.effects);e=b||e;break;case"break":d(function(f){f.finalize()},this.effects);break}a.startOn+=e;a.finishOn+=e;if(!a.options.queue.limit||this.effects.length<a.options.queue.limit){this.effects.push(a)}if(!this.interval){this.interval=this.startLoop(MochiKit.Base.bind(this.loop,this),40)}},startLoop:function(b,a){return setInterval(b,a)},remove:function(a){this.effects=MochiKit.Base.filter(function(b){return b!=a},this.effects);if(!this.effects.length){this.stopLoop(this.interval);this.interval=null}},stopLoop:function(a){clearInterval(a)},loop:function(){var a=new Date().getTime();MochiKit.Base.map(function(b){b.loop(a)},this.effects)}});MochiKit.Visual.Queues={instances:{},get:function(a){if(typeof(a)!="string"){return a}if(!this.instances[a]){this.instances[a]=new MochiKit.Visual.ScopedQueue()}return this.instances[a]}};MochiKit.Visual.Queue=MochiKit.Visual.Queues.get("global");MochiKit.Visual.DefaultOptions={transition:MochiKit.Visual.Transitions.sinoidal,duration:1,fps:25,sync:false,from:0,to:1,delay:0,queue:"parallel"};MochiKit.Visual.Base=function(){};MochiKit.Visual.Base.prototype={__class__:MochiKit.Visual.Base,start:function(a){var b=MochiKit.Visual;this.options=MochiKit.Base.setdefault(a,b.DefaultOptions);this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.event("beforeStart");if(!this.options.sync){b.Queues.get(typeof(this.options.queue)=="string"?"global":this.options.queue.scope).add(this)}},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn){return this.finalize()}var b=(c-this.startOn)/(this.finishOn-this.startOn);var a=Math.round(b*this.options.fps*this.options.duration);if(a>this.currentFrame){this.render(b);this.currentFrame=a}}},render:function(a){if(this.state=="idle"){this.state="running";this.event("beforeSetup");this.setup();this.event("afterSetup")}if(this.state=="running"){if(this.options.transition){a=this.options.transition(a)}a*=(this.options.to-this.options.from);a+=this.options.from;this.event("beforeUpdate");this.update(a);this.event("afterUpdate")}},cancel:function(){if(!this.options.sync){MochiKit.Visual.Queues.get(typeof(this.options.queue)=="string"?"global":this.options.queue.scope).remove(this)}this.state="finished"},finalize:function(){this.render(1);this.cancel();this.event("beforeFinish");this.finish();this.event("afterFinish")},setup:function(){},finish:function(){},update:function(a){},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};MochiKit.Visual.Parallel=function(c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(c,b)}this.__init__(c,b)};MochiKit.Visual.Parallel.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Parallel.prototype,{__class__:MochiKit.Visual.Parallel,__init__:function(b,a){this.effects=b||[];this.start(a)},update:function(a){MochiKit.Base.map(function(b){b.render(a)},this.effects)},finish:function(){MochiKit.Base.map(function(a){a.finalize()},this.effects)}});MochiKit.Visual.Opacity=function(c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(c,b)}this.__init__(c,b)};MochiKit.Visual.Opacity.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Opacity.prototype,{__class__:MochiKit.Visual.Opacity,__init__:function(c,e){var a=MochiKit.Base;var d=MochiKit.Style;this.element=MochiKit.DOM.getElement(c);if(this.element.currentStyle&&(!this.element.currentStyle.hasLayout)){d.setStyle(this.element,{zoom:1})}e=a.update({from:d.getStyle(this.element,"opacity")||0,to:1},e);this.start(e)},update:function(a){MochiKit.Style.setStyle(this.element,{opacity:a})}});MochiKit.Visual.Move=function(a,c){var b=arguments.callee;if(!(this instanceof b)){return new b(a,c)}this.__init__(a,c)};MochiKit.Visual.Move.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Move.prototype,{__class__:MochiKit.Visual.Move,__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);a=MochiKit.Base.update({x:0,y:0,mode:"relative"},a);this.start(a)},setup:function(){MochiKit.DOM.makePositioned(this.element);var a=this.element.style;var c=a.visibility;var b=a.display;if(b=="none"){a.visibility="hidden";a.display=""}this.originalLeft=parseFloat(MochiKit.Style.getStyle(this.element,"left")||"0");this.originalTop=parseFloat(MochiKit.Style.getStyle(this.element,"top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}if(b=="none"){a.visibility=c;a.display=b}},update:function(a){MochiKit.Style.setStyle(this.element,{left:Math.round(this.options.x*a+this.originalLeft)+"px",top:Math.round(this.options.y*a+this.originalTop)+"px"})}});MochiKit.Visual.Scale=function(d,c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(d,c,b)}this.__init__(d,c,b)};MochiKit.Visual.Scale.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Scale.prototype,{__class__:MochiKit.Visual.Scale,__init__:function(a,c,b){this.element=MochiKit.DOM.getElement(a);b=MochiKit.Base.update({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:c},b);this.start(b)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=MochiKit.Style.getStyle(this.element,"position");var d=MochiKit.Base.map;var a=MochiKit.Base.bind;this.originalStyle={};d(a(function(b){this.originalStyle[b]=this.element.style[b]},this),["top","left","width","height","fontSize"]);this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var c=MochiKit.Style.getStyle(this.element,"font-size")||"100%";d(a(function(b){if(c.indexOf(b)>0){this.fontSize=parseFloat(c);this.fontSizeType=b}},this),["em","px","%"]);this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}else{if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}else{this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}}},update:function(a){var b=(this.options.scaleFrom/100)+(this.factor*a);if(this.options.scaleContent&&this.fontSize){MochiKit.Style.setStyle(this.element,{fontSize:this.fontSize*b+this.fontSizeType})}this.setDimensions(this.dims[0]*b,this.dims[1]*b)},finish:function(){if(this.restoreAfterFinish){MochiKit.Style.setStyle(this.element,this.originalStyle)}},setDimensions:function(f,e){var g={};var c=Math.round;if(/MSIE/.test(navigator.userAgent)){c=Math.ceil}if(this.options.scaleX){g.width=c(e)+"px"}if(this.options.scaleY){g.height=c(f)+"px"}if(this.options.scaleFromCenter){var a=(f-this.dims[0])/2;var b=(e-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){g.top=this.originalTop-a+"px"}if(this.options.scaleX){g.left=this.originalLeft-b+"px"}}else{if(this.options.scaleY){g.top=-a+"px"}if(this.options.scaleX){g.left=-b+"px"}}}MochiKit.Style.setStyle(this.element,g)}});MochiKit.Visual.Highlight=function(c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(c,b)}this.__init__(c,b)};MochiKit.Visual.Highlight.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Highlight.prototype,{__class__:MochiKit.Visual.Highlight,__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);a=MochiKit.Base.update({startcolor:"#ffff99"},a);this.start(a)},setup:function(){var a=MochiKit.Base;var c=MochiKit.Style;if(c.getStyle(this.element,"display")=="none"){this.cancel();return}this.oldStyle={backgroundImage:c.getStyle(this.element,"background-image")};c.setStyle(this.element,{backgroundImage:"none"});if(!this.options.endcolor){this.options.endcolor=MochiKit.Color.Color.fromBackground(this.element).toHexString()}if(a.isUndefinedOrNull(this.options.restorecolor)){this.options.restorecolor=c.getStyle(this.element,"background-color")}this._base=a.map(a.bind(function(b){return parseInt(this.options.startcolor.slice(b*2+1,b*2+3),16)},this),[0,1,2]);this._delta=a.map(a.bind(function(b){return parseInt(this.options.endcolor.slice(b*2+1,b*2+3),16)-this._base[b]},this),[0,1,2])},update:function(b){var a="#";MochiKit.Base.map(MochiKit.Base.bind(function(c){a+=MochiKit.Color.toColorPart(Math.round(this._base[c]+this._delta[c]*b))},this),[0,1,2]);MochiKit.Style.setStyle(this.element,{backgroundColor:a})},finish:function(){MochiKit.Style.setStyle(this.element,MochiKit.Base.update(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});MochiKit.Visual.ScrollTo=function(c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(c,b)}this.__init__(c,b)};MochiKit.Visual.ScrollTo.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.ScrollTo.prototype,{__class__:MochiKit.Visual.ScrollTo,__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);this.start(a)},setup:function(){var c=MochiKit.Position;c.prepare();var b=c.cumulativeOffset(this.element);if(this.options.offset){b.y+=this.options.offset}var a;if(window.innerHeight){a=window.innerHeight-window.height}else{if(document.documentElement&&document.documentElement.clientHeight){a=document.documentElement.clientHeight-document.body.scrollHeight}else{if(document.body){a=document.body.clientHeight-document.body.scrollHeight}}}this.scrollStart=c.windowOffset.y;this.delta=(b.y>a?a:b.y)-this.scrollStart},update:function(a){var b=MochiKit.Position;b.prepare();window.scrollTo(b.windowOffset.x,this.scrollStart+(a*this.delta))}});MochiKit.Visual.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;MochiKit.Visual.Morph=function(c,b){var a=arguments.callee;if(!(this instanceof a)){return new a(c,b)}this.__init__(c,b)};MochiKit.Visual.Morph.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Morph.prototype,{__class__:MochiKit.Visual.Morph,__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);this.start(a)},setup:function(){var a=MochiKit.Base;var j=this.options.style;this.styleStart={};this.styleEnd={};this.units={};var g,f;for(var d in j){g=j[d];d=a.camelize(d);if(MochiKit.Visual.CSS_LENGTH.test(g)){var e=g.match(/^([\+\-]?[0-9\.]+)(.*)$/);g=parseFloat(e[1]);f=(e.length==3)?e[2]:null;this.styleEnd[d]=g;this.units[d]=f;g=MochiKit.Style.getStyle(this.element,d);e=g.match(/^([\+\-]?[0-9\.]+)(.*)$/);g=parseFloat(e[1]);this.styleStart[d]=g}else{var h=MochiKit.Color.Color;g=h.fromString(g);if(g){this.units[d]="color";this.styleEnd[d]=g.toHexString();g=MochiKit.Style.getStyle(this.element,d);this.styleStart[d]=h.fromString(g).toHexString();this.styleStart[d]=a.map(a.bind(function(b){return parseInt(this.styleStart[d].slice(b*2+1,b*2+3),16)},this),[0,1,2]);this.styleEnd[d]=a.map(a.bind(function(b){return parseInt(this.styleEnd[d].slice(b*2+1,b*2+3),16)},this),[0,1,2])}}}},update:function(f){var e;for(var d in this.styleStart){if(this.units[d]=="color"){var a="#";var c=this.styleStart[d];var b=this.styleEnd[d];MochiKit.Base.map(MochiKit.Base.bind(function(g){a+=MochiKit.Color.toColorPart(Math.round(c[g]+(b[g]-c[g])*f))},this),[0,1,2]);this.element.style[d]=a}else{e=this.styleStart[d]+Math.round((this.styleEnd[d]-this.styleStart[d])*f*1000)/1000+this.units[d];this.element.style[d]=e}}}});MochiKit.Visual.fade=function(b,a){var c=MochiKit.Style;var d=c.getStyle(b,"opacity");a=MochiKit.Base.update({from:c.getStyle(b,"opacity")||1,to:0,afterFinishInternal:function(e){if(e.options.to!==0){return}c.hideElement(e.element);c.setStyle(e.element,{opacity:d})}},a);return new MochiKit.Visual.Opacity(b,a)};MochiKit.Visual.appear=function(d,c){var b=MochiKit.Style;var a=MochiKit.Visual;c=MochiKit.Base.update({from:(b.getStyle(d,"display")=="none"?0:b.getStyle(d,"opacity")||0),to:1,afterFinishInternal:function(e){a.forceRerendering(e.element)},beforeSetupInternal:function(e){b.setStyle(e.element,{opacity:e.options.from});b.showElement(e.element)}},c);return new a.Opacity(d,c)};MochiKit.Visual.puff=function(e,d){var b=MochiKit.Style;var a=MochiKit.Visual;e=MochiKit.DOM.getElement(e);var c={position:b.getStyle(e,"position"),top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height,opacity:b.getStyle(e,"opacity")};d=MochiKit.Base.update({beforeSetupInternal:function(f){MochiKit.Position.absolutize(f.effects[0].element)},afterFinishInternal:function(f){b.hideElement(f.effects[0].element);b.setStyle(f.effects[0].element,c)},scaleContent:true,scaleFromCenter:true},d);return new a.Parallel([new a.Scale(e,200,{sync:true,scaleFromCenter:d.scaleFromCenter,scaleContent:d.scaleContent,restoreAfterFinish:true}),new a.Opacity(e,{sync:true,to:0})],d)};MochiKit.Visual.blindUp=function(c,b){var e=MochiKit.DOM;c=e.getElement(c);var a=e.makeClipping(c);b=MochiKit.Base.update({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(d){MochiKit.Style.hideElement(d.element);e.undoClipping(d.element,a)}},b);return new MochiKit.Visual.Scale(c,0,b)};MochiKit.Visual.blindDown=function(f,a){var e=MochiKit.DOM;var b=MochiKit.Style;f=e.getElement(f);var g=b.getElementDimensions(f);var c;a=MochiKit.Base.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:g.h,originalWidth:g.w},restoreAfterFinish:true,afterSetupInternal:function(d){c=e.makeClipping(d.element);b.setStyle(d.element,{height:"0px"});b.showElement(d.element)},afterFinishInternal:function(d){e.undoClipping(d.element,c)}},a);return new MochiKit.Visual.Scale(f,100,a)};MochiKit.Visual.switchOff=function(f,e){var g=MochiKit.DOM;f=g.getElement(f);var c=MochiKit.Style.getStyle(f,"opacity");var b;e=MochiKit.Base.update({duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetupInternal:function(d){g.makePositioned(d.element);b=g.makeClipping(d.element)},afterFinishInternal:function(d){MochiKit.Style.hideElement(d.element);g.undoClipping(d.element,b);g.undoPositioned(d.element);MochiKit.Style.setStyle(d.element,{opacity:c})}},e);var a=MochiKit.Visual;return new a.appear(f,{duration:0.4,from:0,transition:a.Transitions.flicker,afterFinishInternal:function(d){new a.Scale(d.element,1,e)}})};MochiKit.Visual.dropOut=function(e,c){var g=MochiKit.DOM;var f=MochiKit.Style;e=g.getElement(e);var a={top:f.getStyle(e,"top"),left:f.getStyle(e,"left"),opacity:f.getStyle(e,"opacity")};c=MochiKit.Base.update({duration:0.5,distance:100,beforeSetupInternal:function(d){g.makePositioned(d.effects[0].element)},afterFinishInternal:function(d){f.hideElement(d.effects[0].element);g.undoPositioned(d.effects[0].element);f.setStyle(d.effects[0].element,a)}},c);var b=MochiKit.Visual;return new b.Parallel([new b.Move(e,{x:0,y:c.distance,sync:true}),new b.Opacity(e,{sync:true,to:0})],c)};MochiKit.Visual.shake=function(g,e){var f=MochiKit.DOM;var a=MochiKit.Visual;var c=MochiKit.Style;g=f.getElement(g);var b={top:c.getStyle(g,"top"),left:c.getStyle(g,"left")};e=MochiKit.Base.update({x:-20,y:0,duration:0.05,afterFinishInternal:function(d){f.undoPositioned(d.element);c.setStyle(d.element,b)}},e);return new a.Move(g,{x:20,y:0,duration:0.05,afterFinishInternal:function(d){new a.Move(d.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(h){new a.Move(h.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(j){new a.Move(j.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(k){new a.Move(k.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(l){new a.Move(l.element,e)}})}})}})}})}})};MochiKit.Visual.slideDown=function(e,c){var j=MochiKit.DOM;var a=MochiKit.Base;var f=MochiKit.Style;e=j.getElement(e);if(!e.firstChild){throw"MochiKit.Visual.slideDown must be used on a element with a child"}j.removeEmptyTextNodes(e);var k=f.getStyle(e.firstChild,"bottom")||0;var h=f.getElementDimensions(e);var g;c=a.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:h.h,originalWidth:h.w},restoreAfterFinish:true,afterSetupInternal:function(b){j.makePositioned(b.element);j.makePositioned(b.element.firstChild);if(/Opera/.test(navigator.userAgent)){f.setStyle(b.element,{top:""})}g=j.makeClipping(b.element);f.setStyle(b.element,{height:"0px"});f.showElement(b.element)},afterUpdateInternal:function(b){f.setStyle(b.element.firstChild,{bottom:(b.dims[0]-b.element.clientHeight)+"px"})},afterFinishInternal:function(b){j.undoClipping(b.element,g);if(/MSIE/.test(navigator.userAgent)){j.undoPositioned(b.element);j.undoPositioned(b.element.firstChild)}else{j.undoPositioned(b.element.firstChild);j.undoPositioned(b.element)}f.setStyle(b.element.firstChild,{bottom:k})}},c);return new MochiKit.Visual.Scale(e,100,c)};MochiKit.Visual.slideUp=function(f,h){var j=MochiKit.DOM;var a=MochiKit.Base;var g=MochiKit.Style;f=j.getElement(f);if(!f.firstChild){throw"MochiKit.Visual.slideUp must be used on a element with a child"}j.removeEmptyTextNodes(f);var e=g.getStyle(f.firstChild,"bottom");var c;h=a.update({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(b){j.makePositioned(b.element);j.makePositioned(b.element.firstChild);if(/Opera/.test(navigator.userAgent)){g.setStyle(b.element,{top:""})}c=j.makeClipping(b.element);g.showElement(b.element)},afterUpdateInternal:function(b){g.setStyle(b.element.firstChild,{bottom:(b.dims[0]-b.element.clientHeight)+"px"})},afterFinishInternal:function(b){g.hideElement(b.element);j.undoClipping(b.element,c);j.undoPositioned(b.element.firstChild);j.undoPositioned(b.element);g.setStyle(b.element.firstChild,{bottom:e})}},h);return new MochiKit.Visual.Scale(f,0,h)};MochiKit.Visual.squish=function(e,c){var g=MochiKit.DOM;var a=MochiKit.Base;var f;c=a.update({restoreAfterFinish:true,beforeSetupInternal:function(b){f=g.makeClipping(b.element)},afterFinishInternal:function(b){MochiKit.Style.hideElement(b.element);g.undoClipping(b.element,f)}},c);return new MochiKit.Visual.Scale(e,/Opera/.test(navigator.userAgent)?1:0,c)};MochiKit.Visual.grow=function(j,h){var k=MochiKit.DOM;var m=MochiKit.Visual;var n=MochiKit.Style;j=k.getElement(j);h=MochiKit.Base.update({direction:"center",moveTransition:m.Transitions.sinoidal,scaleTransition:m.Transitions.sinoidal,opacityTransition:m.Transitions.full,scaleContent:true,scaleFromCenter:false},h);var g={top:j.style.top,left:j.style.left,height:j.style.height,width:j.style.width,opacity:n.getStyle(j,"opacity")};var l=n.getElementDimensions(j);var f,e;var c,b;switch(h.direction){case"top-left":f=e=c=b=0;break;case"top-right":f=l.w;e=b=0;c=-l.w;break;case"bottom-left":f=c=0;e=l.h;b=-l.h;break;case"bottom-right":f=l.w;e=l.h;c=-l.w;b=-l.h;break;case"center":f=l.w/2;e=l.h/2;c=-l.w/2;b=-l.h/2;break}var a=MochiKit.Base.update({beforeSetupInternal:function(d){n.setStyle(d.effects[0].element,{height:"0px"});n.showElement(d.effects[0].element)},afterFinishInternal:function(d){k.undoClipping(d.effects[0].element);k.undoPositioned(d.effects[0].element);n.setStyle(d.effects[0].element,g)}},h);return new m.Move(j,{x:f,y:e,duration:0.01,beforeSetupInternal:function(d){n.hideElement(d.element);k.makeClipping(d.element);k.makePositioned(d.element)},afterFinishInternal:function(d){new m.Parallel([new m.Opacity(d.element,{sync:true,to:1,from:0,transition:h.opacityTransition}),new m.Move(d.element,{x:c,y:b,sync:true,transition:h.moveTransition}),new m.Scale(d.element,100,{scaleMode:{originalHeight:l.h,originalWidth:l.w},sync:true,scaleFrom:/Opera/.test(navigator.userAgent)?1:0,transition:h.scaleTransition,scaleContent:h.scaleContent,scaleFromCenter:h.scaleFromCenter,restoreAfterFinish:true})],a)}})};MochiKit.Visual.shrink=function(f,c){var j=MochiKit.DOM;var l=MochiKit.Visual;var m=MochiKit.Style;f=j.getElement(f);c=MochiKit.Base.update({direction:"center",moveTransition:l.Transitions.sinoidal,scaleTransition:l.Transitions.sinoidal,opacityTransition:l.Transitions.none,scaleContent:true,scaleFromCenter:false},c);var a={top:f.style.top,left:f.style.left,height:f.style.height,width:f.style.width,opacity:m.getStyle(f,"opacity")};var k=m.getElementDimensions(f);var h,g;switch(c.direction){case"top-left":h=g=0;break;case"top-right":h=k.w;g=0;break;case"bottom-left":h=0;g=k.h;break;case"bottom-right":h=k.w;g=k.h;break;case"center":h=k.w/2;g=k.h/2;break}var e;var b=MochiKit.Base.update({beforeStartInternal:function(d){e=j.makePositioned(d.effects[0].element);j.makeClipping(d.effects[0].element)},afterFinishInternal:function(d){m.hideElement(d.effects[0].element);j.undoClipping(d.effects[0].element,e);j.undoPositioned(d.effects[0].element);m.setStyle(d.effects[0].element,a)}},c);return new l.Parallel([new l.Opacity(f,{sync:true,to:0,from:1,transition:c.opacityTransition}),new l.Scale(f,/Opera/.test(navigator.userAgent)?1:0,{sync:true,transition:c.scaleTransition,scaleContent:c.scaleContent,scaleFromCenter:c.scaleFromCenter,restoreAfterFinish:true}),new l.Move(f,{x:h,y:g,sync:true,transition:c.moveTransition})],b)};MochiKit.Visual.pulsate=function(h,f){var j=MochiKit.DOM;var c=MochiKit.Visual;var a=MochiKit.Base;var g=MochiKit.Style.getStyle(h,"opacity");f=a.update({duration:3,from:0,afterFinishInternal:function(b){MochiKit.Style.setStyle(b.element,{opacity:g})}},f);var e=f.transition||c.Transitions.sinoidal;f.transition=function(b){return e(1-c.Transitions.pulse(b,f.pulses))};return new c.Opacity(h,f)};MochiKit.Visual.fold=function(g,f){var h=MochiKit.DOM;var c=MochiKit.Visual;var e=MochiKit.Style;g=h.getElement(g);var b={top:g.style.top,left:g.style.left,width:g.style.width,height:g.style.height};var a=h.makeClipping(g);f=MochiKit.Base.update({scaleContent:false,scaleX:false,afterFinishInternal:function(d){new c.Scale(g,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(j){e.hideElement(j.element);h.undoClipping(j.element,a);e.setStyle(j.element,b)}})}},f);return new c.Scale(g,5,f)};MochiKit.Visual.Color=MochiKit.Color.Color;MochiKit.Visual.getElementsComputedStyle=MochiKit.DOM.computedStyle;MochiKit.Visual.__new__=function(){var a=MochiKit.Base;a.nameFunctions(this);this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)}};MochiKit.Visual.EXPORT=["roundElement","roundClass","tagifyText","multiple","toggle","Parallel","Opacity","Move","Scale","Highlight","ScrollTo","Morph","fade","appear","puff","blindUp","blindDown","switchOff","dropOut","shake","slideDown","slideUp","squish","grow","shrink","pulsate","fold"];MochiKit.Visual.EXPORT_OK=["Base","PAIRS"];MochiKit.Visual.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Visual);if(typeof(MochiKit)=="undefined"){MochiKit={}}if(typeof(MochiKit.MochiKit)=="undefined"){MochiKit.MochiKit={}}MochiKit.MochiKit.NAME="MochiKit.MochiKit";MochiKit.MochiKit.VERSION="1.4";MochiKit.MochiKit.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.MochiKit.toString=function(){return this.__repr__()};MochiKit.MochiKit.SUBMODULES=["Base","Iter","Logging","DateTime","Format","Async","DOM","Selector","Style","LoggingPane","Color","Signal","Position","Visual"];if(typeof(JSAN)!="undefined"||typeof(dojo)!="undefined"){if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.MochiKit");(function(a){for(var b=0;b<a.length;b++){dojo.require("MochiKit."+a[b])}})(MochiKit.MochiKit.SUBMODULES)}if(typeof(JSAN)!="undefined"){(function(a){for(var b=0;b<a.length;b++){JSAN.use("MochiKit."+a[b],[])}})(MochiKit.MochiKit.SUBMODULES)}(function(){var l=MochiKit.Base.extend;var o=MochiKit.MochiKit;var h=o.SUBMODULES;var g=[];var f=[];var e={};var d,b,a,n;for(d=0;d<h.length;d++){a=MochiKit[h[d]];l(g,a.EXPORT);l(f,a.EXPORT_OK);for(b in a.EXPORT_TAGS){e[b]=l(e[b],a.EXPORT_TAGS[b])}n=a.EXPORT_TAGS[":all"];if(!n){n=l(null,a.EXPORT,a.EXPORT_OK)}var c;for(c=0;c<n.length;c++){b=n[c];o[b]=a[b]}}o.EXPORT=g;o.EXPORT_OK=f;o.EXPORT_TAGS=e}())}else{if(typeof(MochiKit.__compat__)=="undefined"){MochiKit.__compat__=true}(function(){if(typeof(document)=="undefined"){return}var e=document.getElementsByTagName("script");var m="http://www.w3.org/1999/xhtml";var l="http://www.w3.org/2000/svg";var k="http://www.w3.org/1999/xlink";var j="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";var b=null;var g=null;var f={};var h;var a;for(h=0;h<e.length;h++){a=null;switch(e[h].namespaceURI){case l:a=e[h].getAttributeNS(k,"href");break;default:a=e[h].getAttribute("src");break}if(!a){continue}f[a]=true;if(a.match(/MochiKit.js$/)){b=a.substring(0,a.lastIndexOf("MochiKit.js"));g=e[h]}}if(b===null){return}var d=MochiKit.MochiKit.SUBMODULES;for(var h=0;h<d.length;h++){if(MochiKit[d[h]]){continue}var c=b+d[h]+".js";if(c in f){continue}if(g.namespaceURI==l||g.namespaceURI==j){var n=document.createElementNS(g.namespaceURI,"script");n.setAttribute("id","MochiKit_"+b+d[h]);if(g.namespaceURI==l){n.setAttributeNS(k,"href",c)}else{n.setAttribute("src",c)}n.setAttribute("type","application/x-javascript");g.parentNode.appendChild(n)}else{document.write("<"+g.nodeName+' src="'+c+'" type="text/javascript"><\/script>')}}})()}var getByTagAndClass=getElementsByTagAndClassName;var getByClass=partial(getByTagAndClass,null);var firstByTagAndClass=getFirstElementByTagAndClassName;var addClass=addElementClass;var removeClass=removeElementClass;
